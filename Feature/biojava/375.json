{"repository":"biojava","prod_path":"biojava-structure/src/main/java/org/biojava/nbio/structure/scop/BerkeleyScopInstallation.java","test_path":"biojava-integrationtest/src/test/java/org/biojava/nbio/structure/test/scop/BerkeleyScopInstallationTest.java","prod_time":"2015-07-23 23:50:43","test_time":"","type":"","proType":"EDIT","add_annotation_line":0,"add_call_line":0,"add_classname_line":0,"add_condition_line":0,"add_field_line":0,"add_import_line":0,"add_packageid_line":0,"add_parameter_line":0,"add_return_line":0,"del_annotation_line":0,"del_call_line":0,"del_classname_line":0,"del_condition_line":0,"del_field_line":0,"del_import_line":0,"del_packageid_line":0,"del_parameter_line":0,"del_return_line":0,"label":"NEGATIVE","prod_commitID":"f78e95991247c98288ed330e42e111ffc910882b","test_commitID":"","isfound":"not found test change","originPro":"/**\n *                    BioJava development code\n *\n * This code may be freely distributed and modified under the\n * terms of the GNU Lesser General Public Licence.  This should\n * be distributed with the code.  If you do not have a copy,\n * see:\n *\n *      http://www.gnu.org/copyleft/lesser.html\n *\n * Copyright for this code is held jointly by the individual\n * authors.  These should be listed in @author doc comments.\n *\n * For more information on the BioJava project and its aims,\n * or to join the biojava-l mailing list, visit the home page\n * at:\n *\n *      http://www.biojava.org/\n *\n * Created on Oct 12, 2011\n * Created by Andreas Prlic\n *\n * @since 3.0.2\n */\npackage org.biojava.nbio.structure.scop;\n\nimport java.util.HashMap;\nimport java.util.Map;\n\n/**\n * The Structural Classification of Proteins at Berkeley Lab and UC Berkeley (<a href=\"http://scop.berkeley.edu/\">http://scop.berkeley.edu/</a>).\n */\npublic class BerkeleyScopInstallation extends ScopInstallation {\n\n\n\tString defaultBerkeleyDownloadURL = \"http://scop.berkeley.edu/downloads/parse/\";\n\tString defaultBerkeleyScopVersion=ScopFactory.LATEST_VERSION;\n\n\t/**\n\t * A map from SCOP version names which the Berkeley server offers as a download to an array of equivalent deprecated SCOP version names.\n\t */\n\tpublic static final Map<String,String[]> EQUIVALENT_VERSIONS = new HashMap<String,String[]>();\n\n\tstatic {\n\t\tEQUIVALENT_VERSIONS.put(\"2.01\", new String[] {\"1.75A\"});\n\t\tEQUIVALENT_VERSIONS.put(\"2.02\", new String[] {\"1.75B\"});\n\t\tEQUIVALENT_VERSIONS.put(\"2.03\", new String[] {\"1.75C\"});\n\t}\n\n\n\tpublic BerkeleyScopInstallation() {\n\t\tsuper();\n\t\tsetScopVersion(defaultBerkeleyScopVersion);\n\t\taddMirror(new BerkeleyScopMirror(defaultBerkeleyDownloadURL));\n\t\taddMirror(new ScopMirror());\n\t}\n\n\tprivate static class BerkeleyScopMirror extends ScopMirror {\n\t\tprivate String rootURL;\n\t\tpublic BerkeleyScopMirror(String url) {\n\t\t\tsuper(url);\n\t\t\trootURL = url;\n\t\t}\n\n\t\t@Override\n\t\tpublic String getClaURL(String scopVersion) {\n\t\t\treturn rootURL+getFilename(\"cla\",scopVersion);\n\t\t}\n\n\t\t@Override\n\t\tpublic String getDesURL(String scopVersion) {\n\t\t\treturn rootURL+getFilename(\"des\",scopVersion);\n\t\t}\n\n\t\t@Override\n\t\tpublic String getHieURL(String scopVersion) {\n\t\t\treturn rootURL+getFilename(\"hie\",scopVersion);\n\t\t}\n\n\t\t@Override\n\t\tpublic String getComURL(String scopVersion) {\n\t\t\treturn rootURL+getFilename(\"com\",scopVersion);\n\t\t}\n\n\t\tprivate String getFilename(String fileType, String version) {\n\t\t\t// Convert to canonical version number\n\t\t\tfor (Map.Entry<String, String[]> entry : EQUIVALENT_VERSIONS.entrySet()) {\n\t\t\t\tfor (String vr : entry.getValue()) {\n\t\t\t\t\tif (version.equals(vr)) {\n\t\t\t\t\t\tversion = entry.getKey();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tString[] parts = version.split(\"\\\\.\");\n\t\t\t// they changed the filename schemes!\n\t\t\tif (Integer.parseInt(parts[0]) == 1) {\n\t\t\t\treturn \"dir.\" + fileType + \".scop.\" + version + \".txt\";\n\t\t\t} else {\n\t\t\t\treturn \"dir.\" + fileType + \".scope.\" + version + \"-stable.txt\";\n\t\t\t}\n\t\t}\n\t\t\n\t\t@Override\n\t\tpublic String toString() {\n\t\t\treturn \"BerkeleyScopMirror[ \\\"\" + rootURL + \" ]\";\n\t\t}\n\t}\n\n}\n","changedPro":"/**\n *                    BioJava development code\n *\n * This code may be freely distributed and modified under the\n * terms of the GNU Lesser General Public Licence.  This should\n * be distributed with the code.  If you do not have a copy,\n * see:\n *\n *      http://www.gnu.org/copyleft/lesser.html\n *\n * Copyright for this code is held jointly by the individual\n * authors.  These should be listed in @author doc comments.\n *\n * For more information on the BioJava project and its aims,\n * or to join the biojava-l mailing list, visit the home page\n * at:\n *\n *      http://www.biojava.org/\n *\n * Created on Oct 12, 2011\n * Created by Andreas Prlic\n *\n * @since 3.0.2\n */\npackage org.biojava.nbio.structure.scop;\n\nimport java.util.HashMap;\nimport java.util.Map;\n\n/**\n * SCOPe:\n * \n * The Structural Classification of Proteins (extended) at Berkeley Lab and UC Berkeley\n * (<a href=\"http://scop.berkeley.edu/\">http://scop.berkeley.edu/</a>).\n * \n * <p>This provides updates to the MRC SCOP hierarchical classification.\n */\npublic class BerkeleyScopInstallation extends ScopInstallation {\n\n\n\tString defaultBerkeleyDownloadURL = \"http://scop.berkeley.edu/downloads/parse/\";\n\tString defaultBerkeleyScopVersion=ScopFactory.LATEST_VERSION;\n\n\t/**\n\t * A map from SCOP version names which the Berkeley server offers as a\n\t * download to an array of equivalent deprecated SCOP version names.\n\t */\n\tpublic static final Map<String,String[]> EQUIVALENT_VERSIONS = new HashMap<String,String[]>();\n\n\tstatic {\n\t\tEQUIVALENT_VERSIONS.put(\"2.01\", new String[] {\"1.75A\"});\n\t\tEQUIVALENT_VERSIONS.put(\"2.02\", new String[] {\"1.75B\"});\n\t\tEQUIVALENT_VERSIONS.put(\"2.03\", new String[] {\"1.75C\"});\n\t}\n\n\n\tpublic BerkeleyScopInstallation() {\n\t\tsuper();\n\t\tsetScopVersion(defaultBerkeleyScopVersion);\n\t\taddMirror(new BerkeleyScopMirror(defaultBerkeleyDownloadURL));\n\t\taddMirror(new ScopMirror());\n\t}\n\n\tprivate static class BerkeleyScopMirror extends ScopMirror {\n\t\tprivate String rootURL;\n\t\tpublic BerkeleyScopMirror(String url) {\n\t\t\tsuper(url);\n\t\t\trootURL = url;\n\t\t}\n\n\t\t@Override\n\t\tpublic String getClaURL(String scopVersion) {\n\t\t\treturn rootURL+getFilename(\"cla\",scopVersion);\n\t\t}\n\n\t\t@Override\n\t\tpublic String getDesURL(String scopVersion) {\n\t\t\treturn rootURL+getFilename(\"des\",scopVersion);\n\t\t}\n\n\t\t@Override\n\t\tpublic String getHieURL(String scopVersion) {\n\t\t\treturn rootURL+getFilename(\"hie\",scopVersion);\n\t\t}\n\n\t\t@Override\n\t\tpublic String getComURL(String scopVersion) {\n\t\t\treturn rootURL+getFilename(\"com\",scopVersion);\n\t\t}\n\n\t\tprivate String getFilename(String fileType, String version) {\n\t\t\t// Convert to canonical version number\n\t\t\tfor (Map.Entry<String, String[]> entry : EQUIVALENT_VERSIONS.entrySet()) {\n\t\t\t\tfor (String vr : entry.getValue()) {\n\t\t\t\t\tif (version.equals(vr)) {\n\t\t\t\t\t\tversion = entry.getKey();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tString[] parts = version.split(\"\\\\.\");\n\t\t\t// they changed the filename schemes!\n\t\t\tif (Integer.parseInt(parts[0]) == 1) {\n\t\t\t\treturn \"dir.\" + fileType + \".scop.\" + version + \".txt\";\n\t\t\t} else {\n\t\t\t\treturn \"dir.\" + fileType + \".scope.\" + version + \"-stable.txt\";\n\t\t\t}\n\t\t}\n\t\t\n\t\t@Override\n\t\tpublic String toString() {\n\t\t\treturn \"BerkeleyScopMirror[ \\\"\" + rootURL + \" ]\";\n\t\t}\n\t}\n\n}\n","originTest":"/**\n *                    BioJava development code\n *\n * This code may be freely distributed and modified under the\n * terms of the GNU Lesser General Public Licence.  This should\n * be distributed with the code.  If you do not have a copy,\n * see:\n *\n *      http://www.gnu.org/copyleft/lesser.html\n *\n * Copyright for this code is held jointly by the individual\n * authors.  These should be listed in @author doc comments.\n *\n * For more information on the BioJava project and its aims,\n * or to join the biojava-l mailing list, visit the home page\n * at:\n *\n *      http://www.biojava.org/\n *\n */\npackage org.biojava.nbio.structure.test.scop;\n\nimport org.biojava.nbio.structure.scop.*;\nimport org.junit.Assume;\nimport org.junit.runner.RunWith;\nimport org.junit.runners.Parameterized;\nimport org.junit.runners.Parameterized.Parameters;\n\nimport java.util.ArrayList;\nimport java.util.Collection;\n\n/**\n * Tests {@link BerkeleyScopInstallation}.\n * @author dmyerstu\n * @since 3.0.6\n */\n@RunWith(Parameterized.class)\npublic class BerkeleyScopInstallationTest extends ScopDatabaseTest {\n\n\tpublic BerkeleyScopInstallationTest(String tag,ScopDatabase scop) {\n\t\tsuper(tag,scop);\n\t}\n\t@Parameters(name=\"{0}\")\n\tpublic static Collection<Object[]> availableDatabases() {\n\t\tArrayList<Object[]> databases = new ArrayList<Object[]>();\n\t\tScopInstallation scop;\n\n\t\tfor(String version : new String[] {\n\t\t\t\t// All versions should pass, but comment most out for test performance.\n\t\t\t\tScopFactory.LATEST_VERSION,\n\t\t\t\t//\"1.75A\",\n\t\t\t\t//ScopFactory.VERSION_2_0_2,\n\t\t\t\tScopFactory.VERSION_1_75,\n\t\t\t\t//ScopFactory.VERSION_1_73,\n\t\t}) {\n\t\t\tscop = new BerkeleyScopInstallation();\n\t\t\tscop.setScopVersion(version);\n\t\t\t// Don't fail if the server is down\n\t\t\tboolean reachable = false;\n\t\t\tfor(ScopMirror mirror: scop.getMirrors()) {\n\t\t\t\tif(mirror.isReachable()) {\n\t\t\t\t\treachable = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tAssume.assumeTrue(\"SCOP server is currently unreachable.\",reachable);\n\n\t\t\tdatabases.add(new Object[] {version, scop});\n\t\t}\n\t\treturn databases;\n\t}\n}","changedTest":"","commitMessage":"Updating SCOPe to version 2.05\n","test_commitMessage":"","allZero":true}