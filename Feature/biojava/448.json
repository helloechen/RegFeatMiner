{"repository":"biojava","prod_path":"biojava-core/src/main/java/org/biojava/nbio/core/search/io/blast/BlastXMLParser.java","test_path":"biojava-core/src/test/java/org/biojava/nbio/core/search/io/blast/BlastXMLParserTest.java","prod_time":"2015-12-01 23:01:40","test_time":"2015-12-01 23:01:40","type":"EDIT","proType":"EDIT","add_annotation_line":0,"add_call_line":0,"add_classname_line":0,"add_condition_line":0,"add_field_line":0,"add_import_line":0,"add_packageid_line":0,"add_parameter_line":0,"add_return_line":0,"del_annotation_line":0,"del_call_line":0,"del_classname_line":0,"del_condition_line":0,"del_field_line":0,"del_import_line":0,"del_packageid_line":0,"del_parameter_line":0,"del_return_line":0,"label":"POSITIVE","prod_commitID":"dbe75e46265ba439971c66c4b9f22fd737cb2c28","test_commitID":"dbe75e46265ba439971c66c4b9f22fd737cb2c28","isfound":"found test change","originPro":"package org.biojava.nbio.core.search.io.blast;\n\n\nimport org.biojava.nbio.core.search.io.Hit;\nimport org.biojava.nbio.core.search.io.Hsp;\nimport org.biojava.nbio.core.search.io.Result;\nimport org.biojava.nbio.core.search.io.ResultFactory;\nimport java.io.File;\nimport java.io.IOException;\nimport java.text.ParseException;\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\nimport javax.xml.parsers.ParserConfigurationException;\nimport javax.xml.xpath.XPathException;\nimport org.biojava.nbio.core.sequence.template.Sequence;\nimport org.biojava.nbio.core.util.XMLHelper;\nimport org.slf4j.LoggerFactory;\nimport org.w3c.dom.Document;\nimport org.w3c.dom.Element;\nimport org.xml.sax.SAXException;\n\n/**\n * Re-designed by Paolo Pavan on the footprint of: \n * org.biojava.nbio.genome.query.BlastXMLQuery by Scooter Willis <willishf at gmail dot com>\n * \n * You may want to find my contacts on Github and LinkedIn for code info \n * or discuss major changes.\n * https://github.com/paolopavan\n * \n *\n * @author Paolo Pavan\n */\npublic class BlastXMLParser implements ResultFactory {\n    private static final org.slf4j.Logger logger = LoggerFactory.getLogger(Hsp.class);\n    Document blastDoc = null;\n    private File targetFile;\n    private List<Sequence> queryReferences, databaseReferences;\n    private Map<String,Sequence> queryReferencesMap, databaseReferencesMap;\n    \n    public BlastXMLParser() {\n        \n    }\n    public void setFile(File f){\n        targetFile = f;\n    }\n    \n    private void readFile(String blastFile) throws IOException, ParseException{\n        logger.info(\"Start reading \" + blastFile);\n        try {\n            blastDoc = XMLHelper.loadXML(blastFile);\n        } catch (SAXException ex) {\n            logger.error(\"A parsing error has occurred while reading XML blast file\");\n            throw new ParseException(ex.getMessage(),0);\n        } catch (ParserConfigurationException ex) {\n            logger.error(\"Internal XML parser non properly configured\");\n            throw new ParseException(ex.getMessage(),0);\n        }\n        logger.info(\"Read finished\");\n    }\n    \n    public List<Result> createObjects(double maxEScore) throws IOException, ParseException {\n        if (targetFile == null) throw new IllegalStateException(\"File to be parsed not specified.\");\n        \n        // getAbsolutePath throws SecurityException\n        readFile(targetFile.getAbsolutePath());\n        // create mappings between sequences and blast id\n        mapIds();\n        \n        ArrayList<Result> resultsCollection;\n        ArrayList<Hit> hitsCollection;\n        ArrayList<Hsp> hspsCollection;\n        \n        try {\n            // select top level elements\n            String program = XMLHelper.selectSingleElement(blastDoc.getDocumentElement(),\"BlastOutput_program\").getTextContent();\n            String version = XMLHelper.selectSingleElement(blastDoc.getDocumentElement(),\"BlastOutput_version\").getTextContent();\n            String reference = XMLHelper.selectSingleElement(blastDoc.getDocumentElement(),\"BlastOutput_reference\").getTextContent();\n            String dbFile = XMLHelper.selectSingleElement(blastDoc.getDocumentElement(),\"BlastOutput_db\").getTextContent();\n\n            logger.info(\"Query for hits in \"+ targetFile);\n            ArrayList<Element> IterationsList = XMLHelper.selectElements(blastDoc.getDocumentElement(), \"BlastOutput_iterations/Iteration[Iteration_hits]\");\n            logger.info(IterationsList.size() + \" results\");\n\n            resultsCollection = new ArrayList<Result>();\n            for (Element element : IterationsList) {\n                BlastResultBuilder resultBuilder = new BlastResultBuilder();\n                // will add BlastOutput* key sections in the result object\n                resultBuilder\n                    .setProgram(program)\n                    .setVersion(version)\n                    .setReference(reference)\n                    .setDbFile(dbFile);\n\n                // Iteration* section keys:\n                resultBuilder\n                    .setIterationNumber(new Integer(XMLHelper.selectSingleElement(element,\"Iteration_iter-num\").getTextContent()))\n                    .setQueryID(XMLHelper.selectSingleElement(element,\"Iteration_query-ID\").getTextContent())\n                    .setQueryDef(XMLHelper.selectSingleElement(element, \"Iteration_query-def\").getTextContent())\n                    .setQueryLength(new Integer(XMLHelper.selectSingleElement(element,\"Iteration_query-len\").getTextContent()));\n                \n                if (queryReferences != null) resultBuilder.setQuerySequence(queryReferencesMap.get(\n                        XMLHelper.selectSingleElement(element,\"Iteration_query-ID\").getTextContent()\n                ));\n\n\n\n                Element iterationHitsElement = XMLHelper.selectSingleElement(element, \"Iteration_hits\");\n                ArrayList<Element> hitList = XMLHelper.selectElements(iterationHitsElement, \"Hit\");\n\n                hitsCollection = new ArrayList<Hit>();\n                for (Element hitElement : hitList) {\n                    BlastHitBuilder blastHitBuilder = new BlastHitBuilder();\n                    blastHitBuilder\n                        .setHitNum(new Integer(XMLHelper.selectSingleElement(hitElement, \"Hit_num\").getTextContent()))\n                        .setHitId(XMLHelper.selectSingleElement(hitElement, \"Hit_id\").getTextContent())\n                        .setHitDef(XMLHelper.selectSingleElement(hitElement, \"Hit_def\").getTextContent())\n                        .setHitAccession(XMLHelper.selectSingleElement(hitElement, \"Hit_accession\").getTextContent())\n                        .setHitLen(new Integer(XMLHelper.selectSingleElement(hitElement, \"Hit_len\").getTextContent()));\n                    \n                    if (databaseReferences != null) blastHitBuilder.setHitSequence(databaseReferencesMap.get(\n                        XMLHelper.selectSingleElement(hitElement, \"Hit_id\").getTextContent()\n                    ));\n\n                    Element hithspsElement = XMLHelper.selectSingleElement(hitElement, \"Hit_hsps\");\n                    ArrayList<Element> hspList = XMLHelper.selectElements(hithspsElement, \"Hsp\");\n\n                    hspsCollection = new ArrayList<Hsp>();\n                    for (Element hspElement : hspList) {\n                        Double evalue = new Double(XMLHelper.selectSingleElement(hspElement, \"Hsp_evalue\").getTextContent());\n\n                        // add the new hsp only if it pass the specified threshold. It can save lot of memory and some parsing time\n                        if (evalue <= maxEScore) {\n                            BlastHspBuilder blastHspBuilder = new BlastHspBuilder();\n                            blastHspBuilder\n                                .setHspNum(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_num\").getTextContent()))\n                                .setHspBitScore(new Double(XMLHelper.selectSingleElement(hspElement, \"Hsp_bit-score\").getTextContent()))\n                                .setHspScore(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_score\").getTextContent()))\n                                .setHspEvalue(evalue)\n                                .setHspQueryFrom(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_query-from\").getTextContent()))\n                                .setHspQueryTo(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_query-to\").getTextContent()))\n                                .setHspHitFrom(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_hit-from\").getTextContent()))\n                                .setHspHitTo(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_hit-to\").getTextContent()))\n                                .setHspQueryFrame(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_query-frame\").getTextContent()))\n                                .setHspHitFrame(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_hit-frame\").getTextContent()))\n                                .setHspIdentity(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_identity\").getTextContent()))\n                                .setHspPositive(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_positive\").getTextContent()))\n                                .setHspGaps(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_gaps\").getTextContent()))\n                                .setHspAlignLen(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_align-len\").getTextContent()))\n                                .setHspQseq(XMLHelper.selectSingleElement(hspElement, \"Hsp_qseq\").getTextContent())\n                                .setHspHseq(XMLHelper.selectSingleElement(hspElement, \"Hsp_hseq\").getTextContent())\n                                .setHspIdentityString(XMLHelper.selectSingleElement(hspElement, \"Hsp_midline\").getTextContent());\n\n                            hspsCollection.add(blastHspBuilder.createBlastHsp());\n                        }\n                    }\n                    // finally set the computed hsp collection and create Hit object\n                    blastHitBuilder.setHsps(hspsCollection);\n                    hitsCollection.add(blastHitBuilder.createBlastHit());\n                }\n                // finally set the computed Hit collection to the result\n                resultBuilder.setHits(hitsCollection);\n                resultsCollection.add(resultBuilder.createBlastResult());\n            }\n        } catch (XPathException e) {\n            throw new ParseException(e.getMessage(),0);\n        }\n        logger.info(\"Parsing of \"+targetFile+\" finished.\");\n        \n        return resultsCollection;\n    }\n    \n    public List<String> getFileExtensions(){\n        ArrayList<String> extensions = new ArrayList<String>(1);\n        extensions.add(\"blastxml\");\n        return extensions;\n    }\n\n    @Override\n    public void setQueryReferences(List<Sequence> sequences) {\n        queryReferences = sequences;\n    }\n\n    @Override\n    public void setDatabaseReferences(List<Sequence> sequences) {\n        databaseReferences = sequences;\n    }\n    \n    /**\n     * fill the map association between sequences an a unique id\n     */\n    private void mapIds() {\n        if (queryReferences != null) {\n            queryReferencesMap = new HashMap<String,Sequence>(queryReferences.size());\n            for (int counter=0; counter < queryReferences.size() ; counter ++){\n                String id = \"Query_\"+(counter+1);\n                queryReferencesMap.put(id, queryReferences.get(counter));\n            }  \n        }\n        \n        if (databaseReferences != null) {\n            databaseReferencesMap = new HashMap<String,Sequence>(databaseReferences.size());\n            for (int counter=0; counter < databaseReferences.size() ; counter ++){\n                // this is strange: while Query_id are 1 based, Hit (database) id are 0 based\n                String id = \"gnl|BL_ORD_ID|\"+(counter);\n                databaseReferencesMap.put(id, databaseReferences.get(counter));\n            }  \n        }\n    }\n\n    @Override\n    public void storeObjects(List<Result> results) throws IOException, ParseException {\n        throw new UnsupportedOperationException(\"This parser does not support writing yet.\");\n    }\n}\n\n\nclass BlastHsp extends org.biojava.nbio.core.search.io.Hsp {\n    public BlastHsp(int hspNum, double hspBitScore, int hspScore, double hspEvalue, int hspQueryFrom, int hspQueryTo, int hspHitFrom, int hspHitTo, int hspQueryFrame, int hspHitFrame, int hspIdentity, int hspPositive, int hspGaps, int hspAlignLen, String hspQseq, String hspHseq, String hspIdentityString, Double percentageIdentity, Integer mismatchCount) {\n        super(hspNum, hspBitScore, hspScore, hspEvalue, hspQueryFrom, hspQueryTo, hspHitFrom, hspHitTo, hspQueryFrame, hspHitFrame, hspIdentity, hspPositive, hspGaps, hspAlignLen, hspQseq, hspHseq, hspIdentityString, percentageIdentity, mismatchCount);\n    }\n    \n}\n\nclass BlastHit extends org.biojava.nbio.core.search.io.Hit {\n    public BlastHit(int hitNum, String hitId, String hitDef, String hitAccession, int hitLen, List<Hsp> hitHsps, Sequence hitSequence) {\n        super(hitNum, hitId, hitDef, hitAccession, hitLen, hitHsps, hitSequence);\n    }\n    \n}","changedPro":"/*\n *                    BioJava development code\n *\n * This code may be freely distributed and modified under the\n * terms of the GNU Lesser General Public Licence.  This should\n * be distributed with the code.  If you do not have a copy,\n * see:\n *\n *      http://www.gnu.org/copyleft/lesser.html\n *\n * Copyright for this code is held jointly by the individual\n * authors.  These should be listed in @author doc comments.\n *\n * For more information on the BioJava project and its aims,\n * or to join the biojava-l mailing list, visit the home page\n * at:\n *\n *      http://www.biojava.org/\n *\n */\npackage org.biojava.nbio.core.search.io.blast;\n\n\nimport org.biojava.nbio.core.search.io.Hit;\nimport org.biojava.nbio.core.search.io.Hsp;\nimport org.biojava.nbio.core.search.io.Result;\nimport org.biojava.nbio.core.search.io.ResultFactory;\nimport java.io.File;\nimport java.io.IOException;\nimport java.text.ParseException;\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\nimport javax.xml.parsers.ParserConfigurationException;\nimport javax.xml.xpath.XPathException;\nimport org.biojava.nbio.core.sequence.template.Sequence;\nimport org.biojava.nbio.core.util.XMLHelper;\nimport org.slf4j.LoggerFactory;\nimport org.w3c.dom.Document;\nimport org.w3c.dom.Element;\nimport org.xml.sax.SAXException;\n\n/**\n * Re-designed by Paolo Pavan on the footprint of: \n * org.biojava.nbio.genome.query.BlastXMLQuery by Scooter Willis <willishf at gmail dot com>\n * \n * You may want to find my contacts on Github and LinkedIn for code info \n * or discuss major changes.\n * https://github.com/paolopavan\n * \n *\n * @author Paolo Pavan\n */\npublic class BlastXMLParser implements ResultFactory {\n    private static final org.slf4j.Logger logger = LoggerFactory.getLogger(Hsp.class);\n    Document blastDoc = null;\n    private File targetFile;\n    private List<Sequence> queryReferences, databaseReferences;\n    private Map<String,Sequence> queryReferencesMap, databaseReferencesMap;\n    \n    public BlastXMLParser() {\n        \n    }\n    public void setFile(File f){\n        targetFile = f;\n    }\n    \n    private void readFile(String blastFile) throws IOException, ParseException{\n        logger.info(\"Start reading \" + blastFile);\n        try {\n            blastDoc = XMLHelper.loadXML(blastFile);\n        } catch (SAXException ex) {\n            logger.error(\"A parsing error has occurred while reading XML blast file\");\n            throw new ParseException(ex.getMessage(),0);\n        } catch (ParserConfigurationException ex) {\n            logger.error(\"Internal XML parser non properly configured\");\n            throw new ParseException(ex.getMessage(),0);\n        }\n        logger.info(\"Read finished\");\n    }\n    \n    public List<Result> createObjects(double maxEScore) throws IOException, ParseException {\n        if (targetFile == null) throw new IllegalStateException(\"File to be parsed not specified.\");\n        \n        // getAbsolutePath throws SecurityException\n        readFile(targetFile.getAbsolutePath());\n        // create mappings between sequences and blast id\n        mapIds();\n        \n        ArrayList<Result> resultsCollection;\n        ArrayList<Hit> hitsCollection;\n        ArrayList<Hsp> hspsCollection;\n        \n        try {\n            // select top level elements\n            String program = XMLHelper.selectSingleElement(blastDoc.getDocumentElement(),\"BlastOutput_program\").getTextContent();\n            String version = XMLHelper.selectSingleElement(blastDoc.getDocumentElement(),\"BlastOutput_version\").getTextContent();\n            String reference = XMLHelper.selectSingleElement(blastDoc.getDocumentElement(),\"BlastOutput_reference\").getTextContent();\n            String dbFile = XMLHelper.selectSingleElement(blastDoc.getDocumentElement(),\"BlastOutput_db\").getTextContent();\n\n            logger.info(\"Query for hits in \"+ targetFile);\n            ArrayList<Element> IterationsList = XMLHelper.selectElements(blastDoc.getDocumentElement(), \"BlastOutput_iterations/Iteration[Iteration_hits]\");\n            logger.info(IterationsList.size() + \" results\");\n\n            resultsCollection = new ArrayList<Result>();\n            for (Element element : IterationsList) {\n                BlastResultBuilder resultBuilder = new BlastResultBuilder();\n                // will add BlastOutput* key sections in the result object\n                resultBuilder\n                    .setProgram(program)\n                    .setVersion(version)\n                    .setReference(reference)\n                    .setDbFile(dbFile);\n\n                // Iteration* section keys:\n                resultBuilder\n                    .setIterationNumber(new Integer(XMLHelper.selectSingleElement(element,\"Iteration_iter-num\").getTextContent()))\n                    .setQueryID(XMLHelper.selectSingleElement(element,\"Iteration_query-ID\").getTextContent())\n                    .setQueryDef(XMLHelper.selectSingleElement(element, \"Iteration_query-def\").getTextContent())\n                    .setQueryLength(new Integer(XMLHelper.selectSingleElement(element,\"Iteration_query-len\").getTextContent()));\n                \n                if (queryReferences != null) resultBuilder.setQuerySequence(queryReferencesMap.get(\n                        XMLHelper.selectSingleElement(element,\"Iteration_query-ID\").getTextContent()\n                ));\n\n\n\n                Element iterationHitsElement = XMLHelper.selectSingleElement(element, \"Iteration_hits\");\n                ArrayList<Element> hitList = XMLHelper.selectElements(iterationHitsElement, \"Hit\");\n\n                hitsCollection = new ArrayList<Hit>();\n                for (Element hitElement : hitList) {\n                    BlastHitBuilder blastHitBuilder = new BlastHitBuilder();\n                    blastHitBuilder\n                        .setHitNum(new Integer(XMLHelper.selectSingleElement(hitElement, \"Hit_num\").getTextContent()))\n                        .setHitId(XMLHelper.selectSingleElement(hitElement, \"Hit_id\").getTextContent())\n                        .setHitDef(XMLHelper.selectSingleElement(hitElement, \"Hit_def\").getTextContent())\n                        .setHitAccession(XMLHelper.selectSingleElement(hitElement, \"Hit_accession\").getTextContent())\n                        .setHitLen(new Integer(XMLHelper.selectSingleElement(hitElement, \"Hit_len\").getTextContent()));\n                    \n                    if (databaseReferences != null) blastHitBuilder.setHitSequence(databaseReferencesMap.get(\n                        XMLHelper.selectSingleElement(hitElement, \"Hit_id\").getTextContent()\n                    ));\n\n                    Element hithspsElement = XMLHelper.selectSingleElement(hitElement, \"Hit_hsps\");\n                    ArrayList<Element> hspList = XMLHelper.selectElements(hithspsElement, \"Hsp\");\n\n                    hspsCollection = new ArrayList<Hsp>();\n                    for (Element hspElement : hspList) {\n                        Double evalue = new Double(XMLHelper.selectSingleElement(hspElement, \"Hsp_evalue\").getTextContent());\n\n                        // add the new hsp only if it pass the specified threshold. It can save lot of memory and some parsing time\n                        if (evalue <= maxEScore) {\n                            BlastHspBuilder blastHspBuilder = new BlastHspBuilder();\n                            blastHspBuilder\n                                .setHspNum(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_num\").getTextContent()))\n                                .setHspBitScore(new Double(XMLHelper.selectSingleElement(hspElement, \"Hsp_bit-score\").getTextContent()))\n                                .setHspScore(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_score\").getTextContent()))\n                                .setHspEvalue(evalue)\n                                .setHspQueryFrom(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_query-from\").getTextContent()))\n                                .setHspQueryTo(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_query-to\").getTextContent()))\n                                .setHspHitFrom(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_hit-from\").getTextContent()))\n                                .setHspHitTo(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_hit-to\").getTextContent()))\n                                .setHspQueryFrame(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_query-frame\").getTextContent()))\n                                .setHspHitFrame(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_hit-frame\").getTextContent()))\n                                .setHspIdentity(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_identity\").getTextContent()))\n                                .setHspPositive(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_positive\").getTextContent()))\n                                .setHspGaps(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_gaps\").getTextContent()))\n                                .setHspAlignLen(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_align-len\").getTextContent()))\n                                .setHspQseq(XMLHelper.selectSingleElement(hspElement, \"Hsp_qseq\").getTextContent())\n                                .setHspHseq(XMLHelper.selectSingleElement(hspElement, \"Hsp_hseq\").getTextContent())\n                                .setHspIdentityString(XMLHelper.selectSingleElement(hspElement, \"Hsp_midline\").getTextContent());\n\n                            hspsCollection.add(blastHspBuilder.createBlastHsp());\n                        }\n                    }\n                    // finally set the computed hsp collection and create Hit object\n                    blastHitBuilder.setHsps(hspsCollection);\n                    hitsCollection.add(blastHitBuilder.createBlastHit());\n                }\n                // finally set the computed Hit collection to the result\n                resultBuilder.setHits(hitsCollection);\n                resultsCollection.add(resultBuilder.createBlastResult());\n            }\n        } catch (XPathException e) {\n            throw new ParseException(e.getMessage(),0);\n        }\n        logger.info(\"Parsing of \"+targetFile+\" finished.\");\n        \n        return resultsCollection;\n    }\n    \n    public List<String> getFileExtensions(){\n        ArrayList<String> extensions = new ArrayList<String>(1);\n        extensions.add(\"blastxml\");\n        return extensions;\n    }\n\n    @Override\n    public void setQueryReferences(List<Sequence> sequences) {\n        queryReferences = sequences;\n    }\n\n    @Override\n    public void setDatabaseReferences(List<Sequence> sequences) {\n        databaseReferences = sequences;\n    }\n    \n    /**\n     * fill the map association between sequences an a unique id\n     */\n    private void mapIds() {\n        if (queryReferences != null) {\n            queryReferencesMap = new HashMap<String,Sequence>(queryReferences.size());\n            for (int counter=0; counter < queryReferences.size() ; counter ++){\n                String id = \"Query_\"+(counter+1);\n                queryReferencesMap.put(id, queryReferences.get(counter));\n            }  \n        }\n        \n        if (databaseReferences != null) {\n            databaseReferencesMap = new HashMap<String,Sequence>(databaseReferences.size());\n            for (int counter=0; counter < databaseReferences.size() ; counter ++){\n                // this is strange: while Query_id are 1 based, Hit (database) id are 0 based\n                String id = \"gnl|BL_ORD_ID|\"+(counter);\n                databaseReferencesMap.put(id, databaseReferences.get(counter));\n            }  \n        }\n    }\n\n    @Override\n    public void storeObjects(List<Result> results) throws IOException, ParseException {\n        throw new UnsupportedOperationException(\"This parser does not support writing yet.\");\n    }\n}\n\n\nclass BlastHsp extends org.biojava.nbio.core.search.io.Hsp {\n    public BlastHsp(int hspNum, double hspBitScore, int hspScore, double hspEvalue, int hspQueryFrom, int hspQueryTo, int hspHitFrom, int hspHitTo, int hspQueryFrame, int hspHitFrame, int hspIdentity, int hspPositive, int hspGaps, int hspAlignLen, String hspQseq, String hspHseq, String hspIdentityString, Double percentageIdentity, Integer mismatchCount) {\n        super(hspNum, hspBitScore, hspScore, hspEvalue, hspQueryFrom, hspQueryTo, hspHitFrom, hspHitTo, hspQueryFrame, hspHitFrame, hspIdentity, hspPositive, hspGaps, hspAlignLen, hspQseq, hspHseq, hspIdentityString, percentageIdentity, mismatchCount);\n    }\n    \n}\n\nclass BlastHit extends org.biojava.nbio.core.search.io.Hit {\n    public BlastHit(int hitNum, String hitId, String hitDef, String hitAccession, int hitLen, List<Hsp> hitHsps, Sequence hitSequence) {\n        super(hitNum, hitId, hitDef, hitAccession, hitLen, hitHsps, hitSequence);\n    }\n    \n}","originTest":"/*\n * To change this license header, choose License Headers in Project Properties.\n * To change this template file, choose Tools | Templates\n * and open the template in the editor.\n */\npackage org.biojava.nbio.core.search.io.blast;\n\nimport java.io.File;\nimport java.net.URL;\nimport java.util.ArrayList;\nimport java.util.List;\nimport org.biojava.nbio.core.search.io.Hit;\nimport org.biojava.nbio.core.search.io.Hsp;\nimport org.biojava.nbio.core.search.io.Result;\nimport org.junit.After;\nimport org.junit.AfterClass;\nimport org.junit.Before;\nimport org.junit.BeforeClass;\nimport org.junit.Test;\nimport static org.junit.Assert.*;\nimport org.junit.Ignore;\n\n/**\n *\n * @author Paolo Pavan\n */\npublic class BlastXMLParserTest {\n    \n    public BlastXMLParserTest() {\n    }\n    \n    @BeforeClass\n    public static void setUpClass() {\n    }\n    \n    @AfterClass\n    public static void tearDownClass() {\n    }\n    \n    @Before\n    public void setUp() {\n    }\n    \n    @After\n    public void tearDown() {\n    }\n\n    /**\n     * Test of setFile method, of class BlastXMLParser.\n     */\n    @Test\n    public void testSetFile() {\n        System.out.println(\"setFile\");\n        File f = null;\n        BlastXMLParser instance = new BlastXMLParser();\n        instance.setFile(f);\n    }\n\n    /**\n     * Test of createObjects method, of class BlastXMLParser.\n     */\n    @Test\n    public void testCreateObjects() throws Exception {\n        System.out.println(\"createObjects\");\n        \n        String resource = \"/org/biojava/nbio/core/search/io/blast/small-blastreport.blastxml\";\n        URL resourceURL = getClass().getResource(resource);\n        File file = new File(resourceURL.getFile());\n        \n        BlastXMLParser instance = new BlastXMLParser();\n        instance.setFile(file);\n        \n        //instance.setQueryReferences(null);\n        //instance.setDatabaseReferences(null);\n        List<Result> result = instance.createObjects(1e-10);\n        \n        // test with random manual selected results\n        BlastHsp hsp1hit1res1 = new BlastHspBuilder()\n                .setHspNum(1)\n                .setHspBitScore(2894.82)\n                .setHspScore(1567)\n                .setHspEvalue(0)\n                .setHspQueryFrom(1)\n                .setHspQueryTo(1567)\n                .setHspHitFrom(616309)\n                .setHspHitTo(617875)\n                .setHspQueryFrame(1)\n                .setHspHitFrame(1)\n                .setHspIdentity(1567)\n                .setHspPositive(1567)\n                .setHspGaps(0)\n                .setHspAlignLen(1567)\n                .setHspQseq(\"TTAAATTGAGAGTTTGATCCTGGCTCAGGATGAACGCTGGTGGCGTGCCTAATACATGCAAGTCGTACGCTAGCCGCTGAATTGATCCTTCGGGTGAAGTGAGGCAATGACTAGAGTGGCGAACTGGTGAGTAACACGTAAGAAACCTGCCCTTTAGTGGGGGATAACATTTGGAAACAGATGCTAATACCGCGTAACAACAAATCACACATGTGATCTGTTTGAAAGGTCCTTTTGGATCGCTAGAGGATGGTCTTGCGGCGTATTAGCTTGTTGGTAGGGTAGAAGCCTACCAAGGCAATGATGCGTAGCCGAGTTGAGAGACTGGCCGGCCACATTGGGACTGAGACACTGCCCAAACTCCTACGGGAGGCTGCAGTAGGGAATTTTCCGCAATGCACGAAAGTGTGACGGAGCGACGCCGCGTGTGTGATGAAGGCTTTCGGGTCGTAAAGCACTGTTGTAAGGGAAGAATAACTGAATTCAGAGAAAGTTTTCAGCTTGACGGTACCTTACCAGAAAGGGATGGCTAAATACGTGCCAGCAGCCGCGGTAATACGTATGTCCCGAGCGTTATCCGGATTTATTGGGCGTAAAGCGAGCGCAGACGGTTTATTAAGTCTGATGTGAAATCCCGAGGCCCAACCTCGGAACTGCATTGGAAACTGATTTACTTGAGTGCGATAGAGGCAAGTGGAACTCCATGTGTAGCGGTGAAATGCGTAGATATGTGGAAGAACACCAGTGGCGAAAGCGGCTTGCTAGATCGTAACTGACGTTGAGGCTCGAAAGTATGGGTAGCAAACGGGATTAGATACCCCGGTAGTCCATACCGTAAACGATGGGTGCTAGTTGTTAAGAGGTTTCCGCCTCCTAGTGACGTAGCAAACGCATTAAGCACCCCGCCTGAGGAGTACGGCCGCAAGGCTAAAACTTAAAGGAATTGACGGGGACCCGCACAAGCGGTGGAGCATGTGGTTTAATTCGAAGATACGCGAAAAACCTTACCAGGTCTTGACATACCAATGATCGCTTTTGTAATGAAAGCTTTTCTTCGGAACATTGGATACAGGTGGTGCATGGTCGTCGTCAGCTCGTGTCGTGAGATGTTGGGTTAAGTCCCGCAACGAGCGCAACCCTTGTTATTAGTTGCCAGCATTTAGTTGGGCACTCTAATGAGACTGCCGGTGATAAACCGGAGGAAGGTGGGGACGACGTCAGATCATCATGCCCCTTATGACCTGGGCAACACACGTGCTACAATGGGAAGTACAACGAGTCGCAAACCGGCGACGGTAAGCTAATCTCTTAAAACTTCTCTCAGTTCGGACTGGAGTCTGCAACTCGACTCCACGAAGGCGGAATCGCTAGTAATCGCGAATCAGCATGTCGCGGTGAATACGTTCCCGGGTCTTGTACACACCGCCCGTCAAATCATGGGAGTCGGAAGTACCCAAAGTCGCTTGGCTAACTTTTAGAGGCCGGTGCCTAAGGTAAAATCGATGACTGGGATTAAGTCGTAACAAGGTAGCCGTAGGAGAACCTGCGGCTGGATCACCTCCTTTCT\")\n                .setHspHseq(\"TTAAATTGAGAGTTTGATCCTGGCTCAGGATGAACGCTGGTGGCGTGCCTAATACATGCAAGTCGTACGCTAGCCGCTGAATTGATCCTTCGGGTGAAGTGAGGCAATGACTAGAGTGGCGAACTGGTGAGTAACACGTAAGAAACCTGCCCTTTAGTGGGGGATAACATTTGGAAACAGATGCTAATACCGCGTAACAACAAATCACACATGTGATCTGTTTGAAAGGTCCTTTTGGATCGCTAGAGGATGGTCTTGCGGCGTATTAGCTTGTTGGTAGGGTAGAAGCCTACCAAGGCAATGATGCGTAGCCGAGTTGAGAGACTGGCCGGCCACATTGGGACTGAGACACTGCCCAAACTCCTACGGGAGGCTGCAGTAGGGAATTTTCCGCAATGCACGAAAGTGTGACGGAGCGACGCCGCGTGTGTGATGAAGGCTTTCGGGTCGTAAAGCACTGTTGTAAGGGAAGAATAACTGAATTCAGAGAAAGTTTTCAGCTTGACGGTACCTTACCAGAAAGGGATGGCTAAATACGTGCCAGCAGCCGCGGTAATACGTATGTCCCGAGCGTTATCCGGATTTATTGGGCGTAAAGCGAGCGCAGACGGTTTATTAAGTCTGATGTGAAATCCCGAGGCCCAACCTCGGAACTGCATTGGAAACTGATTTACTTGAGTGCGATAGAGGCAAGTGGAACTCCATGTGTAGCGGTGAAATGCGTAGATATGTGGAAGAACACCAGTGGCGAAAGCGGCTTGCTAGATCGTAACTGACGTTGAGGCTCGAAAGTATGGGTAGCAAACGGGATTAGATACCCCGGTAGTCCATACCGTAAACGATGGGTGCTAGTTGTTAAGAGGTTTCCGCCTCCTAGTGACGTAGCAAACGCATTAAGCACCCCGCCTGAGGAGTACGGCCGCAAGGCTAAAACTTAAAGGAATTGACGGGGACCCGCACAAGCGGTGGAGCATGTGGTTTAATTCGAAGATACGCGAAAAACCTTACCAGGTCTTGACATACCAATGATCGCTTTTGTAATGAAAGCTTTTCTTCGGAACATTGGATACAGGTGGTGCATGGTCGTCGTCAGCTCGTGTCGTGAGATGTTGGGTTAAGTCCCGCAACGAGCGCAACCCTTGTTATTAGTTGCCAGCATTTAGTTGGGCACTCTAATGAGACTGCCGGTGATAAACCGGAGGAAGGTGGGGACGACGTCAGATCATCATGCCCCTTATGACCTGGGCAACACACGTGCTACAATGGGAAGTACAACGAGTCGCAAACCGGCGACGGTAAGCTAATCTCTTAAAACTTCTCTCAGTTCGGACTGGAGTCTGCAACTCGACTCCACGAAGGCGGAATCGCTAGTAATCGCGAATCAGCATGTCGCGGTGAATACGTTCCCGGGTCTTGTACACACCGCCCGTCAAATCATGGGAGTCGGAAGTACCCAAAGTCGCTTGGCTAACTTTTAGAGGCCGGTGCCTAAGGTAAAATCGATGACTGGGATTAAGTCGTAACAAGGTAGCCGTAGGAGAACCTGCGGCTGGATCACCTCCTTTCT\")\n                .setHspIdentityString(\"|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\")\n                .createBlastHsp();\n        List<Hsp> hsplist = new ArrayList<Hsp>();\n        hsplist.add(hsp1hit1res1);\n        hsplist.add(hsp1hit1res1);\n        \n        BlastHit hit1res1 = new BlastHitBuilder()\n                .setHitNum(1)\n                .setHitId(\"gnl|BL_ORD_ID|2006\")\n                .setHitDef(\"CP000411 Oenococcus oeni PSU-1, complete genome\")\n                .setHitAccession(\"0\")\n                .setHitLen(1780517)\n                .setHsps(hsplist)\n                .createBlastHit();\n        \n        List<Hit> hitlist = new ArrayList<Hit>();\n        hitlist.add(hit1res1);\n        \n        BlastResult res1 = new BlastResultBuilder()\n                .setProgram(\"blastn\")\n                .setVersion(\"BLASTN 2.2.29+\")\n                .setReference(\"Zheng Zhang, Scott Schwartz, Lukas Wagner, and Webb Miller (2000), &quot;A greedy algorithm for aligning DNA sequences&quot;, J Comput Biol 2000; 7(1-2):203-14.\")\n                .setQueryID(\"Query_1\")\n                .setQueryDef(\"CP000411_-_16S_rRNA Oenococcus oeni PSU-1, complete genome\")\n                .setQueryLength(1567)\n                .createBlastResult();\n        \n        Result expRes1 = result.get(0);\n        Hit expHit1res1 = expRes1.iterator().next();\n        Hsp expHsp1hit1res1 = expHit1res1.iterator().next();\n        \n        // result not testable without all hits and hsp\n        //assertEquals(expRes1, res1);\n        \n        // hit test\n        assertEquals(expHit1res1, hit1res1);\n        \n        // hsp test\n        assertEquals(expHsp1hit1res1, hsp1hit1res1);\n    }\n\n    /**\n     * Test of getFileExtensions method, of class BlastXMLParser.\n     */\n    @Test\n    public void testGetFileExtensions() {\n        System.out.println(\"getFileExtensions\");\n        BlastXMLParser instance = new BlastXMLParser();\n        List<String> result = instance.getFileExtensions();\n        assertTrue(result.contains(\"blastxml\"));\n    }\n\n    /**\n     * Test of setQueryReferences method, of class BlastXMLParser.\n     */\n    @Test\n    @Ignore public void testSetQueryReferences() {\n        System.out.println(\"setQueryReferences\");\n        List<org.biojava.nbio.core.sequence.template.Sequence> sequences = null;\n        BlastXMLParser instance = new BlastXMLParser();\n        instance.setQueryReferences(sequences);\n        // TODO review the generated test code and remove the default call to fail.\n        fail(\"The test case is a prototype.\");\n    }\n\n    /**\n     * Test of setDatabaseReferences method, of class BlastXMLParser.\n     */\n    @Test\n    @Ignore public void testSetDatabaseReferences() {\n        System.out.println(\"setDatabaseReferences\");\n        List<org.biojava.nbio.core.sequence.template.Sequence> sequences = null;\n        BlastXMLParser instance = new BlastXMLParser();\n        instance.setDatabaseReferences(sequences);\n        // TODO review the generated test code and remove the default call to fail.\n        fail(\"The test case is a prototype.\");\n    }\n\n    /**\n     * Test of storeObjects method, of class BlastXMLParser.\n     */\n    @Test\n    public void testStoreObjects() throws Exception {\n        // not implemented yet\n    }\n}\n","changedTest":"/*\n *                    BioJava development code\n *\n * This code may be freely distributed and modified under the\n * terms of the GNU Lesser General Public Licence.  This should\n * be distributed with the code.  If you do not have a copy,\n * see:\n *\n *      http://www.gnu.org/copyleft/lesser.html\n *\n * Copyright for this code is held jointly by the individual\n * authors.  These should be listed in @author doc comments.\n *\n * For more information on the BioJava project and its aims,\n * or to join the biojava-l mailing list, visit the home page\n * at:\n *\n *      http://www.biojava.org/\n *\n */\npackage org.biojava.nbio.core.search.io.blast;\n\nimport java.io.File;\nimport java.net.URL;\nimport java.util.ArrayList;\nimport java.util.List;\nimport org.biojava.nbio.core.search.io.Hit;\nimport org.biojava.nbio.core.search.io.Hsp;\nimport org.biojava.nbio.core.search.io.Result;\nimport org.junit.After;\nimport org.junit.AfterClass;\nimport org.junit.Before;\nimport org.junit.BeforeClass;\nimport org.junit.Test;\nimport static org.junit.Assert.*;\nimport org.junit.Ignore;\n\n/**\n *\n * @author Paolo Pavan\n */\npublic class BlastXMLParserTest {\n    \n    public BlastXMLParserTest() {\n    }\n    \n    @BeforeClass\n    public static void setUpClass() {\n    }\n    \n    @AfterClass\n    public static void tearDownClass() {\n    }\n    \n    @Before\n    public void setUp() {\n    }\n    \n    @After\n    public void tearDown() {\n    }\n\n    /**\n     * Test of setFile method, of class BlastXMLParser.\n     */\n    @Test\n    public void testSetFile() {\n        System.out.println(\"setFile\");\n        File f = null;\n        BlastXMLParser instance = new BlastXMLParser();\n        instance.setFile(f);\n    }\n\n    /**\n     * Test of createObjects method, of class BlastXMLParser.\n     */\n    @Test\n    public void testCreateObjects() throws Exception {\n        System.out.println(\"createObjects\");\n        \n        String resource = \"/org/biojava/nbio/core/search/io/blast/small-blastreport.blastxml\";\n        URL resourceURL = getClass().getResource(resource);\n        File file = new File(resourceURL.getFile());\n        \n        BlastXMLParser instance = new BlastXMLParser();\n        instance.setFile(file);\n        \n        //instance.setQueryReferences(null);\n        //instance.setDatabaseReferences(null);\n        List<Result> result = instance.createObjects(1e-10);\n        \n        // test with random manual selected results\n        BlastHsp hsp1hit1res1 = new BlastHspBuilder()\n                .setHspNum(1)\n                .setHspBitScore(2894.82)\n                .setHspScore(1567)\n                .setHspEvalue(0)\n                .setHspQueryFrom(1)\n                .setHspQueryTo(1567)\n                .setHspHitFrom(616309)\n                .setHspHitTo(617875)\n                .setHspQueryFrame(1)\n                .setHspHitFrame(1)\n                .setHspIdentity(1567)\n                .setHspPositive(1567)\n                .setHspGaps(0)\n                .setHspAlignLen(1567)\n                .setHspQseq(\"TTAAATTGAGAGTTTGATCCTGGCTCAGGATGAACGCTGGTGGCGTGCCTAATACATGCAAGTCGTACGCTAGCCGCTGAATTGATCCTTCGGGTGAAGTGAGGCAATGACTAGAGTGGCGAACTGGTGAGTAACACGTAAGAAACCTGCCCTTTAGTGGGGGATAACATTTGGAAACAGATGCTAATACCGCGTAACAACAAATCACACATGTGATCTGTTTGAAAGGTCCTTTTGGATCGCTAGAGGATGGTCTTGCGGCGTATTAGCTTGTTGGTAGGGTAGAAGCCTACCAAGGCAATGATGCGTAGCCGAGTTGAGAGACTGGCCGGCCACATTGGGACTGAGACACTGCCCAAACTCCTACGGGAGGCTGCAGTAGGGAATTTTCCGCAATGCACGAAAGTGTGACGGAGCGACGCCGCGTGTGTGATGAAGGCTTTCGGGTCGTAAAGCACTGTTGTAAGGGAAGAATAACTGAATTCAGAGAAAGTTTTCAGCTTGACGGTACCTTACCAGAAAGGGATGGCTAAATACGTGCCAGCAGCCGCGGTAATACGTATGTCCCGAGCGTTATCCGGATTTATTGGGCGTAAAGCGAGCGCAGACGGTTTATTAAGTCTGATGTGAAATCCCGAGGCCCAACCTCGGAACTGCATTGGAAACTGATTTACTTGAGTGCGATAGAGGCAAGTGGAACTCCATGTGTAGCGGTGAAATGCGTAGATATGTGGAAGAACACCAGTGGCGAAAGCGGCTTGCTAGATCGTAACTGACGTTGAGGCTCGAAAGTATGGGTAGCAAACGGGATTAGATACCCCGGTAGTCCATACCGTAAACGATGGGTGCTAGTTGTTAAGAGGTTTCCGCCTCCTAGTGACGTAGCAAACGCATTAAGCACCCCGCCTGAGGAGTACGGCCGCAAGGCTAAAACTTAAAGGAATTGACGGGGACCCGCACAAGCGGTGGAGCATGTGGTTTAATTCGAAGATACGCGAAAAACCTTACCAGGTCTTGACATACCAATGATCGCTTTTGTAATGAAAGCTTTTCTTCGGAACATTGGATACAGGTGGTGCATGGTCGTCGTCAGCTCGTGTCGTGAGATGTTGGGTTAAGTCCCGCAACGAGCGCAACCCTTGTTATTAGTTGCCAGCATTTAGTTGGGCACTCTAATGAGACTGCCGGTGATAAACCGGAGGAAGGTGGGGACGACGTCAGATCATCATGCCCCTTATGACCTGGGCAACACACGTGCTACAATGGGAAGTACAACGAGTCGCAAACCGGCGACGGTAAGCTAATCTCTTAAAACTTCTCTCAGTTCGGACTGGAGTCTGCAACTCGACTCCACGAAGGCGGAATCGCTAGTAATCGCGAATCAGCATGTCGCGGTGAATACGTTCCCGGGTCTTGTACACACCGCCCGTCAAATCATGGGAGTCGGAAGTACCCAAAGTCGCTTGGCTAACTTTTAGAGGCCGGTGCCTAAGGTAAAATCGATGACTGGGATTAAGTCGTAACAAGGTAGCCGTAGGAGAACCTGCGGCTGGATCACCTCCTTTCT\")\n                .setHspHseq(\"TTAAATTGAGAGTTTGATCCTGGCTCAGGATGAACGCTGGTGGCGTGCCTAATACATGCAAGTCGTACGCTAGCCGCTGAATTGATCCTTCGGGTGAAGTGAGGCAATGACTAGAGTGGCGAACTGGTGAGTAACACGTAAGAAACCTGCCCTTTAGTGGGGGATAACATTTGGAAACAGATGCTAATACCGCGTAACAACAAATCACACATGTGATCTGTTTGAAAGGTCCTTTTGGATCGCTAGAGGATGGTCTTGCGGCGTATTAGCTTGTTGGTAGGGTAGAAGCCTACCAAGGCAATGATGCGTAGCCGAGTTGAGAGACTGGCCGGCCACATTGGGACTGAGACACTGCCCAAACTCCTACGGGAGGCTGCAGTAGGGAATTTTCCGCAATGCACGAAAGTGTGACGGAGCGACGCCGCGTGTGTGATGAAGGCTTTCGGGTCGTAAAGCACTGTTGTAAGGGAAGAATAACTGAATTCAGAGAAAGTTTTCAGCTTGACGGTACCTTACCAGAAAGGGATGGCTAAATACGTGCCAGCAGCCGCGGTAATACGTATGTCCCGAGCGTTATCCGGATTTATTGGGCGTAAAGCGAGCGCAGACGGTTTATTAAGTCTGATGTGAAATCCCGAGGCCCAACCTCGGAACTGCATTGGAAACTGATTTACTTGAGTGCGATAGAGGCAAGTGGAACTCCATGTGTAGCGGTGAAATGCGTAGATATGTGGAAGAACACCAGTGGCGAAAGCGGCTTGCTAGATCGTAACTGACGTTGAGGCTCGAAAGTATGGGTAGCAAACGGGATTAGATACCCCGGTAGTCCATACCGTAAACGATGGGTGCTAGTTGTTAAGAGGTTTCCGCCTCCTAGTGACGTAGCAAACGCATTAAGCACCCCGCCTGAGGAGTACGGCCGCAAGGCTAAAACTTAAAGGAATTGACGGGGACCCGCACAAGCGGTGGAGCATGTGGTTTAATTCGAAGATACGCGAAAAACCTTACCAGGTCTTGACATACCAATGATCGCTTTTGTAATGAAAGCTTTTCTTCGGAACATTGGATACAGGTGGTGCATGGTCGTCGTCAGCTCGTGTCGTGAGATGTTGGGTTAAGTCCCGCAACGAGCGCAACCCTTGTTATTAGTTGCCAGCATTTAGTTGGGCACTCTAATGAGACTGCCGGTGATAAACCGGAGGAAGGTGGGGACGACGTCAGATCATCATGCCCCTTATGACCTGGGCAACACACGTGCTACAATGGGAAGTACAACGAGTCGCAAACCGGCGACGGTAAGCTAATCTCTTAAAACTTCTCTCAGTTCGGACTGGAGTCTGCAACTCGACTCCACGAAGGCGGAATCGCTAGTAATCGCGAATCAGCATGTCGCGGTGAATACGTTCCCGGGTCTTGTACACACCGCCCGTCAAATCATGGGAGTCGGAAGTACCCAAAGTCGCTTGGCTAACTTTTAGAGGCCGGTGCCTAAGGTAAAATCGATGACTGGGATTAAGTCGTAACAAGGTAGCCGTAGGAGAACCTGCGGCTGGATCACCTCCTTTCT\")\n                .setHspIdentityString(\"|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\")\n                .createBlastHsp();\n        List<Hsp> hsplist = new ArrayList<Hsp>();\n        hsplist.add(hsp1hit1res1);\n        hsplist.add(hsp1hit1res1);\n        \n        BlastHit hit1res1 = new BlastHitBuilder()\n                .setHitNum(1)\n                .setHitId(\"gnl|BL_ORD_ID|2006\")\n                .setHitDef(\"CP000411 Oenococcus oeni PSU-1, complete genome\")\n                .setHitAccession(\"0\")\n                .setHitLen(1780517)\n                .setHsps(hsplist)\n                .createBlastHit();\n        \n        List<Hit> hitlist = new ArrayList<Hit>();\n        hitlist.add(hit1res1);\n        \n        BlastResult res1 = new BlastResultBuilder()\n                .setProgram(\"blastn\")\n                .setVersion(\"BLASTN 2.2.29+\")\n                .setReference(\"Zheng Zhang, Scott Schwartz, Lukas Wagner, and Webb Miller (2000), &quot;A greedy algorithm for aligning DNA sequences&quot;, J Comput Biol 2000; 7(1-2):203-14.\")\n                .setQueryID(\"Query_1\")\n                .setQueryDef(\"CP000411_-_16S_rRNA Oenococcus oeni PSU-1, complete genome\")\n                .setQueryLength(1567)\n                .createBlastResult();\n        \n        Result expRes1 = result.get(0);\n        Hit expHit1res1 = expRes1.iterator().next();\n        Hsp expHsp1hit1res1 = expHit1res1.iterator().next();\n        \n        // result not testable without all hits and hsp\n        //assertEquals(expRes1, res1);\n        \n        // hit test\n        assertEquals(expHit1res1, hit1res1);\n        \n        // hsp test\n        assertEquals(expHsp1hit1res1, hsp1hit1res1);\n    }\n\n    /**\n     * Test of getFileExtensions method, of class BlastXMLParser.\n     */\n    @Test\n    public void testGetFileExtensions() {\n        System.out.println(\"getFileExtensions\");\n        BlastXMLParser instance = new BlastXMLParser();\n        List<String> result = instance.getFileExtensions();\n        assertTrue(result.contains(\"blastxml\"));\n    }\n\n    /**\n     * Test of setQueryReferences method, of class BlastXMLParser.\n     */\n    @Test\n    @Ignore public void testSetQueryReferences() {\n        System.out.println(\"setQueryReferences\");\n        List<org.biojava.nbio.core.sequence.template.Sequence> sequences = null;\n        BlastXMLParser instance = new BlastXMLParser();\n        instance.setQueryReferences(sequences);\n        // TODO review the generated test code and remove the default call to fail.\n        fail(\"The test case is a prototype.\");\n    }\n\n    /**\n     * Test of setDatabaseReferences method, of class BlastXMLParser.\n     */\n    @Test\n    @Ignore public void testSetDatabaseReferences() {\n        System.out.println(\"setDatabaseReferences\");\n        List<org.biojava.nbio.core.sequence.template.Sequence> sequences = null;\n        BlastXMLParser instance = new BlastXMLParser();\n        instance.setDatabaseReferences(sequences);\n        // TODO review the generated test code and remove the default call to fail.\n        fail(\"The test case is a prototype.\");\n    }\n\n    /**\n     * Test of storeObjects method, of class BlastXMLParser.\n     */\n    @Test\n    public void testStoreObjects() throws Exception {\n        // not implemented yet\n    }\n}\n","commitMessage":"Adding biojava license statements","test_commitMessage":"Adding biojava license statements","allZero":true}