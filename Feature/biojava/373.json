{"repository":"biojava","prod_path":"biojava-core/src/main/java/org/biojava/nbio/core/search/io/blast/BlastXMLQuery.java","test_path":"biojava-core/src/test/java/org/biojava/nbio/core/search/io/blast/BlastXMLQueryTest.java","prod_time":"2015-07-21 19:09:03","test_time":"2015-07-23 22:37:17","type":"EDIT","proType":"EDIT","add_annotation_line":1,"add_call_line":0,"add_classname_line":0,"add_condition_line":0,"add_field_line":0,"add_import_line":0,"add_packageid_line":0,"add_parameter_line":1,"add_return_line":0,"del_annotation_line":0,"del_call_line":0,"del_classname_line":0,"del_condition_line":0,"del_field_line":0,"del_import_line":0,"del_packageid_line":0,"del_parameter_line":0,"del_return_line":0,"label":"NEGATIVE","prod_commitID":"24b0891a6975861bc226810a545c7287cdec4a46","test_commitID":"c2099e2321ea90ce6a2c86914bd050c7fa2ebdf4","isfound":"found test change","originPro":"/*\r\n * To change this template, choose Tools | Templates\r\n * and open the template in the editor.\r\n */\r\npackage org.biojava.nbio.core.search.io.blast;\r\n\r\n\r\nimport org.biojava.nbio.core.search.io.Hit;\r\nimport org.biojava.nbio.core.search.io.Hsp;\r\nimport org.biojava.nbio.core.search.io.Result;\r\nimport org.biojava.nbio.core.search.io.ResultFactory;\r\nimport java.io.File;\r\nimport java.text.ParseException;\r\nimport java.util.ArrayList;\r\nimport java.util.HashMap;\r\nimport java.util.LinkedHashMap;\r\nimport java.util.List;\r\nimport java.util.Map;\r\nimport java.util.logging.Logger;\r\nimport javax.xml.xpath.XPathException;\r\nimport org.biojava.nbio.core.sequence.template.Sequence;\r\nimport org.biojava.nbio.core.util.XMLHelper;\r\nimport org.w3c.dom.Document;\r\nimport org.w3c.dom.Element;\r\nimport org.xml.sax.SAXException;\r\n\r\n/**\r\n *\r\n * @author Scooter Willis <willishf at gmail dot com>\r\n * @author Paolo Pavan\r\n */\r\npublic class BlastXMLQuery implements ResultFactory {\r\n    private static final Logger log = Logger.getLogger(BlastXMLQuery.class.getName());\r\n    Document blastDoc = null;\r\n    private File targetFile;\r\n    private List<Sequence> queryReferences, databaseReferences;\r\n    private Map<String,Sequence> queryReferencesMap, databaseReferencesMap;\r\n    \r\n    @Deprecated\r\n    public BlastXMLQuery(String blastFile) throws Exception {\r\n        readFile(blastFile);\r\n    }\r\n    \r\n    public BlastXMLQuery() {\r\n        \r\n    }\r\n    public void setFile(File f){\r\n        targetFile = f;\r\n    }\r\n    /**\r\n     * \r\n     * @param maxEScore\r\n     * @return\r\n     * @throws Exception \r\n     */\r\n    @Deprecated\r\n    public LinkedHashMap<String, ArrayList<String>> getHitsQueryDef(double maxEScore) throws Exception {\r\n        LinkedHashMap<String, ArrayList<String>> hitsHashMap = new LinkedHashMap<String, ArrayList<String>>();\r\n        log.info(\"Query for hits\");\r\n        ArrayList<Element> elementList = XMLHelper.selectElements(blastDoc.getDocumentElement(), \"BlastOutput_iterations/Iteration[Iteration_hits]\");\r\n        log.info(elementList.size() + \" hits\");\r\n\r\n        for (Element element : elementList) {\r\n            Element iterationquerydefElement = XMLHelper.selectSingleElement(element, \"Iteration_query-def\");\r\n            String querydef = iterationquerydefElement.getTextContent();\r\n            Element iterationHitsElement = XMLHelper.selectSingleElement(element, \"Iteration_hits\");\r\n            ArrayList<Element> hitList = XMLHelper.selectElements(iterationHitsElement, \"Hit\");\r\n            for (Element hitElement : hitList) {\r\n                Element hitaccessionElement = XMLHelper.selectSingleElement(hitElement, \"Hit_accession\");\r\n                String hitaccession = hitaccessionElement.getTextContent();\r\n                Element hithspsElement = XMLHelper.selectSingleElement(hitElement, \"Hit_hsps\");\r\n                ArrayList<Element> hspList = XMLHelper.selectElements(hithspsElement, \"Hsp\");\r\n                for (Element hspElement : hspList) {\r\n                    Element evalueElement = XMLHelper.selectSingleElement(hspElement, \"Hsp_evalue\");\r\n                    String value = evalueElement.getTextContent();\r\n                    double evalue = Double.parseDouble(value);\r\n                    if (evalue <= maxEScore) {\r\n                        ArrayList<String> hits = hitsHashMap.get(querydef);\r\n                        if (hits == null) {\r\n                            hits = new ArrayList<String>();\r\n                            hitsHashMap.put(querydef, hits);\r\n                        }\r\n                        hits.add(hitaccession);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return hitsHashMap;\r\n    }\r\n    \r\n    private void readFile(String blastFile) throws Exception{\r\n        log.info(\"Start read of \" + blastFile);\r\n        blastDoc = XMLHelper.loadXML(blastFile);\r\n        log.info(\"Read finished\");\r\n    }\r\n    \r\n    public ArrayList<Result> createObjects(double maxEScore) throws ParseException {\r\n        if (targetFile == null) throw new IllegalStateException(\"File to be parsed not specified.\");\r\n        \r\n        try {\r\n            // getAbsolutePath throws SecurityException\r\n            readFile(targetFile.getAbsolutePath());\r\n        } catch (Exception e){\r\n            throw new ParseException(e.getMessage(),0);\r\n        }\r\n        // create mappings between sequences and blast id\r\n        mapIds();\r\n        \r\n        ArrayList<Result> resultsCollection;\r\n        ArrayList<Hit> hitsCollection;\r\n        ArrayList<Hsp> hspsCollection;\r\n        \r\n        try {\r\n            // select top level elements\r\n            String program = XMLHelper.selectSingleElement(blastDoc.getDocumentElement(),\"BlastOutput_program\").getTextContent();\r\n            String version = XMLHelper.selectSingleElement(blastDoc.getDocumentElement(),\"BlastOutput_version\").getTextContent();\r\n            String reference = XMLHelper.selectSingleElement(blastDoc.getDocumentElement(),\"BlastOutput_reference\").getTextContent();\r\n            String dbFile = XMLHelper.selectSingleElement(blastDoc.getDocumentElement(),\"BlastOutput_db\").getTextContent();\r\n\r\n            log.info(\"Query for hits\");\r\n            ArrayList<Element> IterationsList = XMLHelper.selectElements(blastDoc.getDocumentElement(), \"BlastOutput_iterations/Iteration[Iteration_hits]\");\r\n            log.info(IterationsList.size() + \" results\");\r\n\r\n            resultsCollection = new ArrayList();\r\n            for (Element element : IterationsList) {\r\n                BlastResultBuilder resultBuilder = new BlastResultBuilder();\r\n                // will add BlastOutput* key sections in the result object\r\n                resultBuilder\r\n                    .setProgram(program)\r\n                    .setVersion(version)\r\n                    .setReference(reference)\r\n                    .setDbFile(dbFile);\r\n\r\n                // Iteration* section keys:\r\n                resultBuilder\r\n                    .setIterationNumber(new Integer(XMLHelper.selectSingleElement(element,\"Iteration_iter-num\").getTextContent()))\r\n                    .setQueryID(XMLHelper.selectSingleElement(element,\"Iteration_query-ID\").getTextContent())\r\n                    .setQueryDef(XMLHelper.selectSingleElement(element, \"Iteration_query-def\").getTextContent())\r\n                    .setQueryLength(new Integer(XMLHelper.selectSingleElement(element,\"Iteration_query-len\").getTextContent()));\r\n                \r\n                if (queryReferences != null) resultBuilder.setQuerySequence(queryReferencesMap.get(\r\n                        XMLHelper.selectSingleElement(element,\"Iteration_query-ID\").getTextContent()\r\n                ));\r\n\r\n\r\n\r\n                Element iterationHitsElement = XMLHelper.selectSingleElement(element, \"Iteration_hits\");\r\n                ArrayList<Element> hitList = XMLHelper.selectElements(iterationHitsElement, \"Hit\");\r\n\r\n                hitsCollection = new ArrayList();\r\n                for (Element hitElement : hitList) {\r\n                    BlastHitBuilder blastHitBuilder = new BlastHitBuilder();\r\n                    blastHitBuilder\r\n                        .setHitNum(new Integer(XMLHelper.selectSingleElement(hitElement, \"Hit_num\").getTextContent()))\r\n                        .setHitId(XMLHelper.selectSingleElement(hitElement, \"Hit_id\").getTextContent())\r\n                        .setHitDef(XMLHelper.selectSingleElement(hitElement, \"Hit_def\").getTextContent())\r\n                        .setHitAccession(XMLHelper.selectSingleElement(hitElement, \"Hit_accession\").getTextContent())\r\n                        .setHitLen(new Integer(XMLHelper.selectSingleElement(hitElement, \"Hit_len\").getTextContent()));\r\n                    \r\n                    if (databaseReferences != null) blastHitBuilder.setHitSequence(databaseReferencesMap.get(\r\n                        XMLHelper.selectSingleElement(hitElement, \"Hit_id\").getTextContent()\r\n                    ));\r\n\r\n                    Element hithspsElement = XMLHelper.selectSingleElement(hitElement, \"Hit_hsps\");\r\n                    ArrayList<Element> hspList = XMLHelper.selectElements(hithspsElement, \"Hsp\");\r\n\r\n                    hspsCollection = new ArrayList();\r\n                    for (Element hspElement : hspList) {\r\n                        Double evalue = new Double(XMLHelper.selectSingleElement(hspElement, \"Hsp_evalue\").getTextContent());\r\n\r\n                        // add the new hsp only if it pass the specified threshold. It can save lot of memory and some parsing time\r\n                        if (evalue <= maxEScore) {\r\n                            BlastHspBuilder blastHspBuilder = new BlastHspBuilder();\r\n                            blastHspBuilder\r\n                                .setHspNum(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_num\").getTextContent()))\r\n                                .setHspBitScore(new Double(XMLHelper.selectSingleElement(hspElement, \"Hsp_bit-score\").getTextContent()))\r\n                                .setHspScore(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_score\").getTextContent()))\r\n                                .setHspEvalue(evalue)\r\n                                .setHspQueryFrom(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_query-from\").getTextContent()))\r\n                                .setHspQueryTo(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_query-to\").getTextContent()))\r\n                                .setHspHitFrom(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_hit-from\").getTextContent()))\r\n                                .setHspHitTo(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_hit-to\").getTextContent()))\r\n                                .setHspQueryFrame(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_query-frame\").getTextContent()))\r\n                                .setHspHitFrame(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_hit-frame\").getTextContent()))\r\n                                .setHspIdentity(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_identity\").getTextContent()))\r\n                                .setHspPositive(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_positive\").getTextContent()))\r\n                                .setHspGaps(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_gaps\").getTextContent()))\r\n                                .setHspAlignLen(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_align-len\").getTextContent()))\r\n                                .setHspQseq(XMLHelper.selectSingleElement(hspElement, \"Hsp_qseq\").getTextContent())\r\n                                .setHspHseq(XMLHelper.selectSingleElement(hspElement, \"Hsp_hseq\").getTextContent())\r\n                                .setHspIdentityString(XMLHelper.selectSingleElement(hspElement, \"Hsp_midline\").getTextContent());\r\n\r\n                            hspsCollection.add(blastHspBuilder.createBlastHsp());\r\n                        }\r\n                    }\r\n                    // finally set the computed hsp collection and create Hit object\r\n                    blastHitBuilder.setHsps(hspsCollection);\r\n                    hitsCollection.add(blastHitBuilder.createBlastHit());\r\n                }\r\n                // finally set the computed Hit collection to the result\r\n                resultBuilder.setHits(hitsCollection);\r\n                resultsCollection.add(resultBuilder.createBlastResult());\r\n            }\r\n        } catch (XPathException e) {\r\n            throw new ParseException(e.getMessage(),0);\r\n        }\r\n        log.info(\"Parsing finished.\");\r\n        \r\n        return resultsCollection;\r\n    }\r\n    \r\n    public List<String> getFileExtensions(){\r\n        ArrayList<String> extensions = new ArrayList(1);\r\n        extensions.add(\"blastxml\");\r\n        return extensions;\r\n    }\r\n\r\n    @Override\r\n    public void setQueryReferences(List sequences) {\r\n        queryReferences = sequences;\r\n    }\r\n\r\n    @Override\r\n    public void setDatabaseReferences(List sequences) {\r\n        databaseReferences = sequences;\r\n    }\r\n    \r\n    /**\r\n     * fill the map association between sequences an a unique id\r\n     */\r\n    private void mapIds() {\r\n        if (queryReferences != null) {\r\n            queryReferencesMap = new HashMap(queryReferences.size());\r\n            for (int counter=0; counter < queryReferences.size() ; counter ++){\r\n                String id = \"Query_\"+(counter+1);\r\n                queryReferencesMap.put(id, queryReferences.get(counter));\r\n            }  \r\n        }\r\n        \r\n        if (databaseReferences != null) {\r\n            databaseReferencesMap = new HashMap(databaseReferences.size());\r\n            for (int counter=0; counter < databaseReferences.size() ; counter ++){\r\n                // this is strange: while Query_id are 1 based, Hit (database) id are 0 based\r\n                String id = \"gnl|BL_ORD_ID|\"+(counter);\r\n                databaseReferencesMap.put(id, databaseReferences.get(counter));\r\n            }  \r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nclass BlastHsp extends org.biojava.nbio.core.search.io.Hsp {\r\n    public BlastHsp(int hspNum, double hspBitScore, int hspScore, double hspEvalue, int hspQueryFrom, int hspQueryTo, int hspHitFrom, int hspHitTo, int hspQueryFrame, int hspHitFrame, int hspIdentity, int hspPositive, int hspGaps, int hspAlignLen, String hspQseq, String hspHseq, String hspIdentityString) {\r\n        super(hspNum, hspBitScore, hspScore, hspEvalue, hspQueryFrom, hspQueryTo, hspHitFrom, hspHitTo, hspQueryFrame, hspHitFrame, hspIdentity, hspPositive, hspGaps, hspAlignLen, hspQseq, hspHseq, hspIdentityString);\r\n    }\r\n    \r\n}\r\n\r\nclass BlastHit extends org.biojava.nbio.core.search.io.Hit {\r\n    public BlastHit(int hitNum, String hitId, String hitDef, String hitAccession, int hitLen, ArrayList<Hsp> hitHsps, Sequence hitSequence) {\r\n        super(hitNum, hitId, hitDef, hitAccession, hitLen, hitHsps, hitSequence);\r\n    }\r\n    \r\n}","changedPro":"/*\r\n * To change this template, choose Tools | Templates\r\n * and open the template in the editor.\r\n */\r\npackage org.biojava.nbio.core.search.io.blast;\r\n\r\n\r\nimport org.biojava.nbio.core.search.io.Hit;\r\nimport org.biojava.nbio.core.search.io.Hsp;\r\nimport org.biojava.nbio.core.search.io.Result;\r\nimport org.biojava.nbio.core.search.io.ResultFactory;\r\nimport java.io.File;\r\nimport java.text.ParseException;\r\nimport java.util.ArrayList;\r\nimport java.util.HashMap;\r\nimport java.util.LinkedHashMap;\r\nimport java.util.List;\r\nimport java.util.Map;\r\nimport java.util.logging.Logger;\r\nimport javax.xml.xpath.XPathException;\r\nimport org.biojava.nbio.core.sequence.template.Sequence;\r\nimport org.biojava.nbio.core.util.XMLHelper;\r\nimport org.w3c.dom.Document;\r\nimport org.w3c.dom.Element;\r\nimport org.xml.sax.SAXException;\r\n\r\n/**\r\n *\r\n * @author Scooter Willis <willishf at gmail dot com>\r\n * @author Paolo Pavan\r\n */\r\npublic class BlastXMLQuery implements ResultFactory {\r\n    private static final Logger log = Logger.getLogger(BlastXMLQuery.class.getName());\r\n    Document blastDoc = null;\r\n    private File targetFile;\r\n    private List<Sequence> queryReferences, databaseReferences;\r\n    private Map<String,Sequence> queryReferencesMap, databaseReferencesMap;\r\n    \r\n    @Deprecated\r\n    public BlastXMLQuery(String blastFile) throws Exception {\r\n        readFile(blastFile);\r\n    }\r\n    \r\n    public BlastXMLQuery() {\r\n        \r\n    }\r\n    public void setFile(File f){\r\n        targetFile = f;\r\n    }\r\n    /**\r\n     * \r\n     * @param maxEScore\r\n     * @return\r\n     * @throws Exception \r\n     */\r\n    @Deprecated\r\n    public LinkedHashMap<String, ArrayList<String>> getHitsQueryDef(double maxEScore) throws Exception {\r\n        LinkedHashMap<String, ArrayList<String>> hitsHashMap = new LinkedHashMap<String, ArrayList<String>>();\r\n        log.info(\"Query for hits\");\r\n        ArrayList<Element> elementList = XMLHelper.selectElements(blastDoc.getDocumentElement(), \"BlastOutput_iterations/Iteration[Iteration_hits]\");\r\n        log.info(elementList.size() + \" hits\");\r\n\r\n        for (Element element : elementList) {\r\n            Element iterationquerydefElement = XMLHelper.selectSingleElement(element, \"Iteration_query-def\");\r\n            String querydef = iterationquerydefElement.getTextContent();\r\n            Element iterationHitsElement = XMLHelper.selectSingleElement(element, \"Iteration_hits\");\r\n            ArrayList<Element> hitList = XMLHelper.selectElements(iterationHitsElement, \"Hit\");\r\n            for (Element hitElement : hitList) {\r\n                Element hitaccessionElement = XMLHelper.selectSingleElement(hitElement, \"Hit_accession\");\r\n                String hitaccession = hitaccessionElement.getTextContent();\r\n                Element hithspsElement = XMLHelper.selectSingleElement(hitElement, \"Hit_hsps\");\r\n                ArrayList<Element> hspList = XMLHelper.selectElements(hithspsElement, \"Hsp\");\r\n                for (Element hspElement : hspList) {\r\n                    Element evalueElement = XMLHelper.selectSingleElement(hspElement, \"Hsp_evalue\");\r\n                    String value = evalueElement.getTextContent();\r\n                    double evalue = Double.parseDouble(value);\r\n                    if (evalue <= maxEScore) {\r\n                        ArrayList<String> hits = hitsHashMap.get(querydef);\r\n                        if (hits == null) {\r\n                            hits = new ArrayList<String>();\r\n                            hitsHashMap.put(querydef, hits);\r\n                        }\r\n                        hits.add(hitaccession);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return hitsHashMap;\r\n    }\r\n    \r\n    private void readFile(String blastFile) throws Exception{\r\n        log.info(\"Start read of \" + blastFile);\r\n        blastDoc = XMLHelper.loadXML(blastFile);\r\n        log.info(\"Read finished\");\r\n    }\r\n    \r\n    public ArrayList<Result> createObjects(double maxEScore) throws ParseException {\r\n        if (targetFile == null) throw new IllegalStateException(\"File to be parsed not specified.\");\r\n        \r\n        try {\r\n            // getAbsolutePath throws SecurityException\r\n            readFile(targetFile.getAbsolutePath());\r\n        } catch (Exception e){\r\n            throw new ParseException(e.getMessage(),0);\r\n        }\r\n        // create mappings between sequences and blast id\r\n        mapIds();\r\n        \r\n        ArrayList<Result> resultsCollection;\r\n        ArrayList<Hit> hitsCollection;\r\n        ArrayList<Hsp> hspsCollection;\r\n        \r\n        try {\r\n            // select top level elements\r\n            String program = XMLHelper.selectSingleElement(blastDoc.getDocumentElement(),\"BlastOutput_program\").getTextContent();\r\n            String version = XMLHelper.selectSingleElement(blastDoc.getDocumentElement(),\"BlastOutput_version\").getTextContent();\r\n            String reference = XMLHelper.selectSingleElement(blastDoc.getDocumentElement(),\"BlastOutput_reference\").getTextContent();\r\n            String dbFile = XMLHelper.selectSingleElement(blastDoc.getDocumentElement(),\"BlastOutput_db\").getTextContent();\r\n\r\n            log.info(\"Query for hits\");\r\n            ArrayList<Element> IterationsList = XMLHelper.selectElements(blastDoc.getDocumentElement(), \"BlastOutput_iterations/Iteration[Iteration_hits]\");\r\n            log.info(IterationsList.size() + \" results\");\r\n\r\n            resultsCollection = new ArrayList();\r\n            for (Element element : IterationsList) {\r\n                BlastResultBuilder resultBuilder = new BlastResultBuilder();\r\n                // will add BlastOutput* key sections in the result object\r\n                resultBuilder\r\n                    .setProgram(program)\r\n                    .setVersion(version)\r\n                    .setReference(reference)\r\n                    .setDbFile(dbFile);\r\n\r\n                // Iteration* section keys:\r\n                resultBuilder\r\n                    .setIterationNumber(new Integer(XMLHelper.selectSingleElement(element,\"Iteration_iter-num\").getTextContent()))\r\n                    .setQueryID(XMLHelper.selectSingleElement(element,\"Iteration_query-ID\").getTextContent())\r\n                    .setQueryDef(XMLHelper.selectSingleElement(element, \"Iteration_query-def\").getTextContent())\r\n                    .setQueryLength(new Integer(XMLHelper.selectSingleElement(element,\"Iteration_query-len\").getTextContent()));\r\n                \r\n                if (queryReferences != null) resultBuilder.setQuerySequence(queryReferencesMap.get(\r\n                        XMLHelper.selectSingleElement(element,\"Iteration_query-ID\").getTextContent()\r\n                ));\r\n\r\n\r\n\r\n                Element iterationHitsElement = XMLHelper.selectSingleElement(element, \"Iteration_hits\");\r\n                ArrayList<Element> hitList = XMLHelper.selectElements(iterationHitsElement, \"Hit\");\r\n\r\n                hitsCollection = new ArrayList();\r\n                for (Element hitElement : hitList) {\r\n                    BlastHitBuilder blastHitBuilder = new BlastHitBuilder();\r\n                    blastHitBuilder\r\n                        .setHitNum(new Integer(XMLHelper.selectSingleElement(hitElement, \"Hit_num\").getTextContent()))\r\n                        .setHitId(XMLHelper.selectSingleElement(hitElement, \"Hit_id\").getTextContent())\r\n                        .setHitDef(XMLHelper.selectSingleElement(hitElement, \"Hit_def\").getTextContent())\r\n                        .setHitAccession(XMLHelper.selectSingleElement(hitElement, \"Hit_accession\").getTextContent())\r\n                        .setHitLen(new Integer(XMLHelper.selectSingleElement(hitElement, \"Hit_len\").getTextContent()));\r\n                    \r\n                    if (databaseReferences != null) blastHitBuilder.setHitSequence(databaseReferencesMap.get(\r\n                        XMLHelper.selectSingleElement(hitElement, \"Hit_id\").getTextContent()\r\n                    ));\r\n\r\n                    Element hithspsElement = XMLHelper.selectSingleElement(hitElement, \"Hit_hsps\");\r\n                    ArrayList<Element> hspList = XMLHelper.selectElements(hithspsElement, \"Hsp\");\r\n\r\n                    hspsCollection = new ArrayList();\r\n                    for (Element hspElement : hspList) {\r\n                        Double evalue = new Double(XMLHelper.selectSingleElement(hspElement, \"Hsp_evalue\").getTextContent());\r\n\r\n                        // add the new hsp only if it pass the specified threshold. It can save lot of memory and some parsing time\r\n                        if (evalue <= maxEScore) {\r\n                            BlastHspBuilder blastHspBuilder = new BlastHspBuilder();\r\n                            blastHspBuilder\r\n                                .setHspNum(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_num\").getTextContent()))\r\n                                .setHspBitScore(new Double(XMLHelper.selectSingleElement(hspElement, \"Hsp_bit-score\").getTextContent()))\r\n                                .setHspScore(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_score\").getTextContent()))\r\n                                .setHspEvalue(evalue)\r\n                                .setHspQueryFrom(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_query-from\").getTextContent()))\r\n                                .setHspQueryTo(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_query-to\").getTextContent()))\r\n                                .setHspHitFrom(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_hit-from\").getTextContent()))\r\n                                .setHspHitTo(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_hit-to\").getTextContent()))\r\n                                .setHspQueryFrame(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_query-frame\").getTextContent()))\r\n                                .setHspHitFrame(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_hit-frame\").getTextContent()))\r\n                                .setHspIdentity(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_identity\").getTextContent()))\r\n                                .setHspPositive(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_positive\").getTextContent()))\r\n                                .setHspGaps(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_gaps\").getTextContent()))\r\n                                .setHspAlignLen(new Integer(XMLHelper.selectSingleElement(hspElement, \"Hsp_align-len\").getTextContent()))\r\n                                .setHspQseq(XMLHelper.selectSingleElement(hspElement, \"Hsp_qseq\").getTextContent())\r\n                                .setHspHseq(XMLHelper.selectSingleElement(hspElement, \"Hsp_hseq\").getTextContent())\r\n                                .setHspIdentityString(XMLHelper.selectSingleElement(hspElement, \"Hsp_midline\").getTextContent());\r\n\r\n                            hspsCollection.add(blastHspBuilder.createBlastHsp());\r\n                        }\r\n                    }\r\n                    // finally set the computed hsp collection and create Hit object\r\n                    blastHitBuilder.setHsps(hspsCollection);\r\n                    hitsCollection.add(blastHitBuilder.createBlastHit());\r\n                }\r\n                // finally set the computed Hit collection to the result\r\n                resultBuilder.setHits(hitsCollection);\r\n                resultsCollection.add(resultBuilder.createBlastResult());\r\n            }\r\n        } catch (XPathException e) {\r\n            throw new ParseException(e.getMessage(),0);\r\n        }\r\n        log.info(\"Parsing finished.\");\r\n        \r\n        return resultsCollection;\r\n    }\r\n    \r\n    public List<String> getFileExtensions(){\r\n        ArrayList<String> extensions = new ArrayList(1);\r\n        extensions.add(\"blastxml\");\r\n        return extensions;\r\n    }\r\n\r\n    @Override\r\n    public void setQueryReferences(List sequences) {\r\n        queryReferences = sequences;\r\n    }\r\n\r\n    @Override\r\n    public void setDatabaseReferences(List sequences) {\r\n        databaseReferences = sequences;\r\n    }\r\n    \r\n    /**\r\n     * fill the map association between sequences an a unique id\r\n     */\r\n    private void mapIds() {\r\n        if (queryReferences != null) {\r\n            queryReferencesMap = new HashMap(queryReferences.size());\r\n            for (int counter=0; counter < queryReferences.size() ; counter ++){\r\n                String id = \"Query_\"+(counter+1);\r\n                queryReferencesMap.put(id, queryReferences.get(counter));\r\n            }  \r\n        }\r\n        \r\n        if (databaseReferences != null) {\r\n            databaseReferencesMap = new HashMap(databaseReferences.size());\r\n            for (int counter=0; counter < databaseReferences.size() ; counter ++){\r\n                // this is strange: while Query_id are 1 based, Hit (database) id are 0 based\r\n                String id = \"gnl|BL_ORD_ID|\"+(counter);\r\n                databaseReferencesMap.put(id, databaseReferences.get(counter));\r\n            }  \r\n        }\r\n    }\r\n\r\n    @Override\r\n    public void storeObjects(List<Result> results) throws Exception {\r\n        throw new UnsupportedOperationException(\"This parser does not support writing yet.\");\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nclass BlastHsp extends org.biojava.nbio.core.search.io.Hsp {\r\n    public BlastHsp(int hspNum, double hspBitScore, int hspScore, double hspEvalue, int hspQueryFrom, int hspQueryTo, int hspHitFrom, int hspHitTo, int hspQueryFrame, int hspHitFrame, int hspIdentity, int hspPositive, int hspGaps, int hspAlignLen, String hspQseq, String hspHseq, String hspIdentityString) {\r\n        super(hspNum, hspBitScore, hspScore, hspEvalue, hspQueryFrom, hspQueryTo, hspHitFrom, hspHitTo, hspQueryFrame, hspHitFrame, hspIdentity, hspPositive, hspGaps, hspAlignLen, hspQseq, hspHseq, hspIdentityString);\r\n    }\r\n    \r\n}\r\n\r\nclass BlastHit extends org.biojava.nbio.core.search.io.Hit {\r\n    public BlastHit(int hitNum, String hitId, String hitDef, String hitAccession, int hitLen, ArrayList<Hsp> hitHsps, Sequence hitSequence) {\r\n        super(hitNum, hitId, hitDef, hitAccession, hitLen, hitHsps, hitSequence);\r\n    }\r\n    \r\n}","originTest":"/*\r\n * To change this license header, choose License Headers in Project Properties.\r\n * To change this template file, choose Tools | Templates\r\n * and open the template in the editor.\r\n */\r\npackage org.biojava.nbio.core.search.io.blast;\r\n\r\nimport java.io.File;\r\nimport java.io.FileOutputStream;\r\nimport java.io.IOException;\r\nimport java.io.InputStream;\r\nimport java.io.OutputStream;\r\nimport java.net.URL;\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\nimport org.biojava.nbio.core.search.io.Hit;\r\nimport org.biojava.nbio.core.search.io.Hsp;\r\nimport org.biojava.nbio.core.search.io.Result;\r\nimport org.biojava.nbio.core.sequence.io.util.ClasspathResource;\r\nimport org.junit.After;\r\nimport org.junit.AfterClass;\r\nimport org.junit.Before;\r\nimport org.junit.BeforeClass;\r\nimport org.junit.Test;\r\nimport static org.junit.Assert.*;\r\nimport org.junit.Ignore;\r\n\r\n/**\r\n *\r\n * @author pavanpa\r\n */\r\npublic class BlastXMLQueryTest {\r\n    \r\n    public BlastXMLQueryTest() {\r\n    }\r\n    \r\n    @BeforeClass\r\n    public static void setUpClass() {\r\n    }\r\n    \r\n    @AfterClass\r\n    public static void tearDownClass() {\r\n    }\r\n    \r\n    @Before\r\n    public void setUp() {\r\n    }\r\n    \r\n    @After\r\n    public void tearDown() {\r\n    }\r\n\r\n    /**\r\n     * Test of setFile method, of class BlastXMLQuery.\r\n     */\r\n    @Test\r\n    public void testSetFile() {\r\n        System.out.println(\"setFile\");\r\n        File f = null;\r\n        BlastXMLQuery instance = new BlastXMLQuery();\r\n        instance.setFile(f);\r\n    }\r\n\r\n    /**\r\n     * Test of createObjects method, of class BlastXMLQuery.\r\n     */\r\n    @Test\r\n    public void testCreateObjects() throws Exception {\r\n        System.out.println(\"createObjects\");\r\n        String resource = \"/org/biojava/nbio/core/search/io/blast/testBlastReport.xml\";\r\n        \r\n        URL resourceURL = getClass().getResource(resource);\r\n        File file = new File(resourceURL.getFile());\r\n        \r\n        BlastXMLQuery instance = new BlastXMLQuery();\r\n        instance.setFile(file);\r\n        \r\n        //instance.setQueryReferences(null);\r\n        //instance.setDatabaseReferences(null);\r\n        ArrayList<Result> result = instance.createObjects(Double.MAX_VALUE);\r\n        \r\n        // test with random manual selected results\r\n        BlastHsp hsp1hit1res1 = new BlastHspBuilder()\r\n                .setHspNum(1)\r\n                .setHspBitScore(377.211)\r\n                .setHspEvalue(8.04143e-093)\r\n                .setHspQueryFrom(1)\r\n                .setHspQueryTo(224)\r\n                .setHspHitFrom(1035)\r\n                .setHspHitTo(811)\r\n                .setHspQueryFrame(-1)\r\n                .setHspIdentity(213)\r\n                .setHspPositive(213)\r\n                .setHspGaps(5)\r\n                .setHspAlignLen(227)\r\n                .setHspQseq(\"CTGACGACAGCCATGCACCACCTGTCTCGACTTTCCCCCGAAGGGCACCTAATGTATCTCTACCTCGTTAGTCGGATGTCAAGACCTGGTAAGGTTTTTTCGCGTATCTTCGAATTAAACCACATACTCCACTGCTTGTGCGG-CCCCCGTCAATTCCTTTGAGTTTCAACCTTGCGGCCGTACTCCC-AGGTGGA-TACTTATTGTGTTAACTCCGGCACGGAAGG\")\r\n                .setHspHseq(\"CTGACGACAACCATGCACCACCTGTCTCAACTTTCCCC-GAAGGGCACCTAATGTATCTCTACTTCGTTAGTTGGATGTCAAGACCTGGTAAGGTT-CTTCGCGTTGCTTCGAATTAAACCACATACTCCACTGCTTGTGCGGGCCCCCGTCAATTCCTTTGAGTTTCAACCTTGCGGTCGTACTCCCCAGGTGGATTACTTATTGTGTTAACTCCGGCACAGAAGG\")\r\n                .setHspIdentityString(\"||||||||| |||||||||||||||||| ||||||||| |||||||||||||||||||||||| |||||||| |||||||||||||||||||||||  |||||||  |||||||||||||||||||||||||||||||||||| |||||||||||||||||||||||||||||||||| ||||||||| ||||||| |||||||||||||||||||||||| |||||\")\r\n                .createBlastHsp();\r\n        BlastHit hit1res1 = new BlastHitBuilder()\r\n                .setHitNum(1)\r\n                .setHitId(\"gnl|BL_ORD_ID|2006\")\r\n                .setHitDef(\"gi|265679047|ref|NR_029355.1| Clostridium methylpentosum DSM 5476 strain R2 16S ribosomal RNA, partial sequence\")\r\n                .setHitAccession(\"2006\")\r\n                .setHitLen(1435)\r\n                .createBlastHit();\r\n        \r\n        BlastResult res1 = new BlastResultBuilder()\r\n                .setProgram(\"blastn\")\r\n                .setVersion(\"BLASTN 2.2.29+\")\r\n                .setReference(\"Zheng Zhang, Scott Schwartz, Lukas Wagner, and Webb Miller (2000), &quot;A greedy algorithm for aligning DNA sequences&quot;, J Comput Biol 2000; 7(1-2):203-14.\")\r\n                .setQueryID(\"Query_1\")\r\n                .setQueryDef(\"42DKN:00022:00047\")\r\n                .setQueryLength(226)\r\n                .createBlastResult();\r\n        \r\n        Result expRes1 = result.get(0);\r\n        Hit expHit1res1 = expRes1.iterator().next();\r\n        Hsp expHsp1hit1res1 = expHit1res1.iterator().next();\r\n        \r\n        // result test\r\n        assertEquals(expRes1, res1);\r\n        \r\n        // hit test\r\n        assertEquals(expHit1res1, hit1res1);\r\n        \r\n        // hsp test\r\n        assertEquals(expHsp1hit1res1, hsp1hit1res1);\r\n    }\r\n\r\n    /**\r\n     * Test of getFileExtensions method, of class BlastXMLQuery.\r\n     */\r\n    @Test\r\n    @Ignore public void testGetFileExtensions() {\r\n        System.out.println(\"getFileExtensions\");\r\n        BlastXMLQuery instance = new BlastXMLQuery();\r\n        List<String> expResult = null;\r\n        List<String> result = instance.getFileExtensions();\r\n        assertEquals(expResult, result);\r\n        // TODO review the generated test code and remove the default call to fail.\r\n        fail(\"The test case is a prototype.\");\r\n    }\r\n\r\n    /**\r\n     * Test of setQueryReferences method, of class BlastXMLQuery.\r\n     */\r\n    @Test\r\n    @Ignore public void testSetQueryReferences() {\r\n        System.out.println(\"setQueryReferences\");\r\n        List sequences = null;\r\n        BlastXMLQuery instance = new BlastXMLQuery();\r\n        instance.setQueryReferences(sequences);\r\n        // TODO review the generated test code and remove the default call to fail.\r\n        fail(\"The test case is a prototype.\");\r\n    }\r\n\r\n    /**\r\n     * Test of setDatabaseReferences method, of class BlastXMLQuery.\r\n     */\r\n    @Test\r\n    @Ignore public void testSetDatabaseReferences() {\r\n        System.out.println(\"setDatabaseReferences\");\r\n        List sequences = null;\r\n        BlastXMLQuery instance = new BlastXMLQuery();\r\n        instance.setDatabaseReferences(sequences);\r\n        // TODO review the generated test code and remove the default call to fail.\r\n        fail(\"The test case is a prototype.\");\r\n    }\r\n\r\n    /**\r\n     * Test of storeObjects method, of class BlastXMLQuery.\r\n     */\r\n    @Test\r\n    public void testStoreObjects() throws Exception {\r\n        // not implemented yet\r\n    }\r\n    \r\n    private File unpackResourceFile(String resource) {\r\n        \r\n        File file = null;\r\n        URL res = getClass().getResource(resource);\r\n        if (res == null) {\r\n            throw new RuntimeException(\" not supported\");\r\n        }\r\n        if (res.toString().startsWith(\"jar:\")) {\r\n            try {\r\n                InputStream input = getClass().getResourceAsStream(resource);\r\n                file = File.createTempFile(\"javawrapped\", \".exe\");\r\n                //if (!DEBUG) file.deleteOnExit();\r\n                file.setExecutable(true, true);\r\n                OutputStream out = new FileOutputStream(file);\r\n                int read;\r\n                byte[] bytes = new byte[1024];\r\n\r\n                while ((read = input.read(bytes)) != -1) {\r\n                    out.write(bytes, 0, read);\r\n                }\r\n                out.close();\r\n                out.flush();\r\n            } catch (IOException ex) {\r\n                throw new RuntimeException(\"Resource not available for this OS!\");\r\n            } \r\n        } else {\r\n            //this will probably work in your IDE, but not from a JAR\r\n            file = new File(res.getFile());\r\n        }\r\n\r\n        if (file == null) {\r\n            throw new RuntimeException(\"Error: File \" + file + \" not found!\");\r\n        }\r\n        return file;\r\n    }\r\n    \r\n}\r\n","changedTest":"/*\r\n * To change this license header, choose License Headers in Project Properties.\r\n * To change this template file, choose Tools | Templates\r\n * and open the template in the editor.\r\n */\r\npackage org.biojava.nbio.core.search.io.blast;\r\n\r\nimport java.io.File;\r\nimport java.io.FileOutputStream;\r\nimport java.io.IOException;\r\nimport java.io.InputStream;\r\nimport java.io.OutputStream;\r\nimport java.net.URL;\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\nimport org.biojava.nbio.core.search.io.Hit;\r\nimport org.biojava.nbio.core.search.io.Hsp;\r\nimport org.biojava.nbio.core.search.io.Result;\r\nimport org.junit.After;\r\nimport org.junit.AfterClass;\r\nimport org.junit.Before;\r\nimport org.junit.BeforeClass;\r\nimport org.junit.Test;\r\nimport static org.junit.Assert.*;\r\nimport org.junit.Ignore;\r\n\r\n/**\r\n *\r\n * @author pavanpa\r\n */\r\npublic class BlastXMLQueryTest {\r\n    \r\n    public BlastXMLQueryTest() {\r\n    }\r\n    \r\n    @BeforeClass\r\n    public static void setUpClass() {\r\n    }\r\n    \r\n    @AfterClass\r\n    public static void tearDownClass() {\r\n    }\r\n    \r\n    @Before\r\n    public void setUp() {\r\n    }\r\n    \r\n    @After\r\n    public void tearDown() {\r\n    }\r\n\r\n    /**\r\n     * Test of setFile method, of class BlastXMLQuery.\r\n     */\r\n    @Test\r\n    public void testSetFile() {\r\n        System.out.println(\"setFile\");\r\n        File f = null;\r\n        BlastXMLQuery instance = new BlastXMLQuery();\r\n        instance.setFile(f);\r\n    }\r\n\r\n    /**\r\n     * Test of createObjects method, of class BlastXMLQuery.\r\n     */\r\n    @Test\r\n    public void testCreateObjects() throws Exception {\r\n        System.out.println(\"createObjects\");\r\n        \r\n        String resource = \"/org/biojava/nbio/core/search/io/blast/testBlastReport.xml\";\r\n        URL resourceURL = getClass().getResource(resource);\r\n        File file = new File(resourceURL.getFile());\r\n        \r\n        BlastXMLQuery instance = new BlastXMLQuery();\r\n        instance.setFile(file);\r\n        \r\n        //instance.setQueryReferences(null);\r\n        //instance.setDatabaseReferences(null);\r\n        ArrayList<Result> result = instance.createObjects(1e-10);\r\n        \r\n        // test with random manual selected results\r\n        BlastHsp hsp1hit1res1 = new BlastHspBuilder()\r\n                .setHspNum(1)\r\n                .setHspBitScore(377.211)\r\n                .setHspEvalue(8.04143e-093)\r\n                .setHspQueryFrom(1)\r\n                .setHspQueryTo(224)\r\n                .setHspHitFrom(1035)\r\n                .setHspHitTo(811)\r\n                .setHspQueryFrame(-1)\r\n                .setHspIdentity(213)\r\n                .setHspPositive(213)\r\n                .setHspGaps(5)\r\n                .setHspAlignLen(227)\r\n                .setHspQseq(\"CTGACGACAGCCATGCACCACCTGTCTCGACTTTCCCCCGAAGGGCACCTAATGTATCTCTACCTCGTTAGTCGGATGTCAAGACCTGGTAAGGTTTTTTCGCGTATCTTCGAATTAAACCACATACTCCACTGCTTGTGCGG-CCCCCGTCAATTCCTTTGAGTTTCAACCTTGCGGCCGTACTCCC-AGGTGGA-TACTTATTGTGTTAACTCCGGCACGGAAGG\")\r\n                .setHspHseq(\"CTGACGACAACCATGCACCACCTGTCTCAACTTTCCCC-GAAGGGCACCTAATGTATCTCTACTTCGTTAGTTGGATGTCAAGACCTGGTAAGGTT-CTTCGCGTTGCTTCGAATTAAACCACATACTCCACTGCTTGTGCGGGCCCCCGTCAATTCCTTTGAGTTTCAACCTTGCGGTCGTACTCCCCAGGTGGATTACTTATTGTGTTAACTCCGGCACAGAAGG\")\r\n                .setHspIdentityString(\"||||||||| |||||||||||||||||| ||||||||| |||||||||||||||||||||||| |||||||| |||||||||||||||||||||||  |||||||  |||||||||||||||||||||||||||||||||||| |||||||||||||||||||||||||||||||||| ||||||||| ||||||| |||||||||||||||||||||||| |||||\")\r\n                .createBlastHsp();\r\n        BlastHit hit1res1 = new BlastHitBuilder()\r\n                .setHitNum(1)\r\n                .setHitId(\"gnl|BL_ORD_ID|2006\")\r\n                .setHitDef(\"gi|265679047|ref|NR_029355.1| Clostridium methylpentosum DSM 5476 strain R2 16S ribosomal RNA, partial sequence\")\r\n                .setHitAccession(\"2006\")\r\n                .setHitLen(1435)\r\n                .createBlastHit();\r\n        \r\n        BlastResult res1 = new BlastResultBuilder()\r\n                .setProgram(\"blastn\")\r\n                .setVersion(\"BLASTN 2.2.29+\")\r\n                .setReference(\"Zheng Zhang, Scott Schwartz, Lukas Wagner, and Webb Miller (2000), &quot;A greedy algorithm for aligning DNA sequences&quot;, J Comput Biol 2000; 7(1-2):203-14.\")\r\n                .setQueryID(\"Query_1\")\r\n                .setQueryDef(\"42DKN:00022:00047\")\r\n                .setQueryLength(226)\r\n                .createBlastResult();\r\n        \r\n        Result expRes1 = result.get(0);\r\n        Hit expHit1res1 = expRes1.iterator().next();\r\n        Hsp expHsp1hit1res1 = expHit1res1.iterator().next();\r\n        \r\n        // result test\r\n        assertEquals(expRes1, res1);\r\n        \r\n        // hit test\r\n        assertEquals(expHit1res1, hit1res1);\r\n        \r\n        // hsp test\r\n        assertEquals(expHsp1hit1res1, hsp1hit1res1);\r\n    }\r\n\r\n    /**\r\n     * Test of getFileExtensions method, of class BlastXMLQuery.\r\n     */\r\n    @Test\r\n    @Ignore public void testGetFileExtensions() {\r\n        System.out.println(\"getFileExtensions\");\r\n        BlastXMLQuery instance = new BlastXMLQuery();\r\n        List<String> expResult = null;\r\n        List<String> result = instance.getFileExtensions();\r\n        assertEquals(expResult, result);\r\n        // TODO review the generated test code and remove the default call to fail.\r\n        fail(\"The test case is a prototype.\");\r\n    }\r\n\r\n    /**\r\n     * Test of setQueryReferences method, of class BlastXMLQuery.\r\n     */\r\n    @Test\r\n    @Ignore public void testSetQueryReferences() {\r\n        System.out.println(\"setQueryReferences\");\r\n        List sequences = null;\r\n        BlastXMLQuery instance = new BlastXMLQuery();\r\n        instance.setQueryReferences(sequences);\r\n        // TODO review the generated test code and remove the default call to fail.\r\n        fail(\"The test case is a prototype.\");\r\n    }\r\n\r\n    /**\r\n     * Test of setDatabaseReferences method, of class BlastXMLQuery.\r\n     */\r\n    @Test\r\n    @Ignore public void testSetDatabaseReferences() {\r\n        System.out.println(\"setDatabaseReferences\");\r\n        List sequences = null;\r\n        BlastXMLQuery instance = new BlastXMLQuery();\r\n        instance.setDatabaseReferences(sequences);\r\n        // TODO review the generated test code and remove the default call to fail.\r\n        fail(\"The test case is a prototype.\");\r\n    }\r\n\r\n    /**\r\n     * Test of storeObjects method, of class BlastXMLQuery.\r\n     */\r\n    @Test\r\n    public void testStoreObjects() throws Exception {\r\n        // not implemented yet\r\n    }\r\n    \r\n    private File unpackResourceFile(String resource) {\r\n        \r\n        File file = null;\r\n        URL res = getClass().getResource(resource);\r\n        if (res == null) {\r\n            throw new RuntimeException(\" not supported\");\r\n        }\r\n        if (res.toString().startsWith(\"jar:\")) {\r\n            try {\r\n                InputStream input = getClass().getResourceAsStream(resource);\r\n                file = File.createTempFile(\"javawrapped\", \".exe\");\r\n                //if (!DEBUG) file.deleteOnExit();\r\n                file.setExecutable(true, true);\r\n                OutputStream out = new FileOutputStream(file);\r\n                int read;\r\n                byte[] bytes = new byte[1024];\r\n\r\n                while ((read = input.read(bytes)) != -1) {\r\n                    out.write(bytes, 0, read);\r\n                }\r\n                out.close();\r\n                out.flush();\r\n            } catch (IOException ex) {\r\n                throw new RuntimeException(\"Resource not available for this OS!\");\r\n            } \r\n        } else {\r\n            //this will probably work in your IDE, but not from a JAR\r\n            file = new File(res.getFile());\r\n        }\r\n\r\n        if (file == null) {\r\n            throw new RuntimeException(\"Error: File \" + file + \" not found!\");\r\n        }\r\n        return file;\r\n    }\r\n    \r\n}\r\n","commitMessage":"Updated after interface modification","test_commitMessage":"test improvement.","allZero":false}